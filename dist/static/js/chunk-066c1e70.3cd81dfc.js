(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-066c1e70"],{"30c2":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"g",(function(){return c})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return r})),n.d(e,"h",(function(){return s})),n.d(e,"f",(function(){return l})),n.d(e,"d",(function(){return u})),n.d(e,"e",(function(){return h}));var a=n("b775");function i(t){return Object(a["a"])({url:"/contract/attach/getinfo/"+t,method:"get"})}function c(t){return Object(a["a"])({url:"/contract/sign",method:"post",data:t})}function o(t){return Object(a["a"])({url:"/contract/attach/param",method:"get",params:t})}function r(t){return Object(a["a"])({url:"/contract/attach",method:"post",data:t})}function s(t){return Object(a["a"])({url:"/contract/attach",method:"put",data:t})}function l(t){return Object(a["a"])({url:"/sign/seal/getSealList",method:"get",params:t})}function u(t){return Object(a["a"])({url:"/contract/attach/getPic/"+t,method:"get"})}function h(t){return Object(a["a"])({url:"/contract/attach/perfect/"+t,method:"get"})}},"4ec9":function(t,e,n){"use strict";var a=n("6d61"),i=n("6566");t.exports=a("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),i)},9410:function(t,e,n){"use strict";n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return f}));var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.item?n("div",[n("el-form-item",{attrs:{label:t.item.title,prop:t.item.name}},[n("el-input",{attrs:{placeholder:t.item.prompt_msg,size:"mini"},on:{input:t.handleInput},model:{value:t.perInfo[t.item.val],callback:function(e){t.$set(t.perInfo,t.item.val,e)},expression:"perInfo[item.val]"}})],1)],1):t._e()},i=[],c=(n("b0c0"),{name:"String",props:["item"],data:function(){return{perInfo:{input:this.item.value}}},created:function(){this.handleInput(this.item.value)},methods:{handleInput:function(t){this.$emit("change",{name:this.item.name,value:t})},resetData:function(){console.log("我是子组件的方法1"),this.$ref.resetFields()}}}),o=c,r=n("0c7c"),s=Object(r["a"])(o,a,i,!1,null,null,null),l=s.exports,u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.item?n("div",[n("el-form-item",{attrs:{label:t.item.title,prop:t.item.name}},[n("el-input-number",{attrs:{min:1,max:1110,size:"mini",precision:2,"controls-position":"right"},on:{change:t.handleChange},model:{value:t.perInfo[t.item.val],callback:function(e){t.$set(t.perInfo,t.item.val,e)},expression:"perInfo[item.val]"}})],1)],1):t._e()},h=[],d={props:["item"],data:function(){return{perInfo:{}}},created:function(){this.$set(this.perInfo,this.item.val,this.item.value)},methods:{handleChange:function(t){this.$emit("change",{name:this.item.name,value:t})},resetData:function(){console.log("我是子组件的方法"),this.resetForm("queryForm")}}},m=d,p=Object(r["a"])(m,u,h,!1,null,null,null),f=p.exports,g=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.item?n("div",[n("el-form-item",{attrs:{label:t.item.title,prop:t.item.name}},[n("el-select",{attrs:{placeholder:t.item.prompt_msg,size:"mini"},on:{change:t.handleChange},model:{value:t.perInfo[t.item.val],callback:function(e){t.$set(t.perInfo,t.item.val,e)},expression:"perInfo[item.val]"}},t._l(t.statusOptions,(function(t){return n("el-option",{key:t.dictValue,attrs:{label:t.dictLabel,value:t.dictValue}})})),1)],1)],1):t._e()},v=[],_={name:"Select_item",props:["item"],data:function(){return{perInfo:{},statusOptions:[]}},created:function(){var t=this;this.$set(this.perInfo,this.item.val,this.item.value),this.getDicts(this.item.selectOptionsType).then((function(e){t.statusOptions=e.data}))},methods:{handleChange:function(t){this.$emit("change",{name:this.item.name,value:t})},resetData:function(){console.log("我是子组件的方法"),this.resetForm(perInfo)}}},b=_,x=Object(r["a"])(b,g,v,!1,null,null,null);x.exports},adc1:function(t,e,n){"use strict";n.d(e,"f",(function(){return i})),n.d(e,"e",(function(){return c})),n.d(e,"a",(function(){return o})),n.d(e,"h",(function(){return r})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return l})),n.d(e,"g",(function(){return u})),n.d(e,"d",(function(){return h}));var a=n("b775");function i(t){return Object(a["a"])({url:"/contract/info/list",method:"post",data:t})}function c(t){return Object(a["a"])({url:"/contract/info/"+t,method:"get"})}function o(t){return Object(a["a"])({url:"/contract/info",method:"post",data:t})}function r(t){return Object(a["a"])({url:"/contract/info",method:"put",data:t})}function s(t){return Object(a["a"])({url:"/contract/info/"+t,method:"delete"})}function l(t){return Object(a["a"])({url:"/contract/info/export",method:"get",params:t})}function u(t){return Object(a["a"])({url:"/contract/info/sendContract",method:"put",data:t})}function h(t){return Object(a["a"])({url:"/contract/info/count",method:"Get",data:t})}},b70c:function(t,e,n){},ba49:function(t,e,n){"use strict";n("b70c")},bd43:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pageContent_2lAGg",attrs:{id:"pageContent"}},[n("div",{staticClass:"leftContent_2NoKi"},[n("div",{staticClass:"doc-list-context"},[n("el-row",[n("el-col",{attrs:{span:23}},[n("div",{staticClass:"doc-list-title"},[t._v("文件列表 "),n("span",[t._v("("+t._s(this.contract_attach.length)+"份)")])])]),n("el-col",{staticStyle:{"margin-top":"10px"},attrs:{span:1}},[n("div",{staticClass:"fileList"},[n("el-popover",{attrs:{placement:"right-start",width:"280",trigger:"hover"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[n("div",{staticStyle:{"text-align":"left",margin:"0"}},[n("el-button",{staticStyle:{"margin-bottom":"10px"},attrs:{type:"text",size:"mini"},on:{click:function(e){return t.downcontact(t.contract_info)}}},[t._v("下载")]),n("div",{staticStyle:{"font-size":"11px",color:"#333","margin-bottom":"5px"}},[t._v(t._s(this.contract_info.name))]),n("el-row",[n("div",{staticStyle:{"font-size":"11px",color:"#333"}},[t._v("于"+t._s(t.parseTime(this.contract_info.updateTime,"{y}年{m}月{d}日{h}:{m}:{s}")+t.statusdict[this.contract_info.status]))])])],1),n("svg-icon",{staticStyle:{"font-size":"22px","margin-left":"10px"},attrs:{slot:"reference","class-name":"search-icon","icon-class":"shudian"},slot:"reference"})],1)],1)])],1),n("div",{staticClass:"doc-list"},[n("div",{staticClass:"doc-item"},[n("div",[n("el-carousel",{attrs:{height:"200px",type:"card",autoplay:!1},on:{change:t.handelChange}},t._l(t.contract_attach,(function(e,a){return n("el-carousel-item",{key:a},[n("div",{staticClass:"doc-name"},[t._v(t._s(e.contractDocName))]),n("el-image",{attrs:{src:t.baseurl+e.contractImgList[0].contractImgUrl,alt:""},nativeOn:{click:function(n){return t.jump(1,e.id)}}})],1)})),1)],1)])])],1)]),n("div",{staticClass:"pdfContent_1PW2f"},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isShow,expression:"isShow"}],ref:"pdfBox",staticClass:"pdf-container",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.1)"}},[n("div",{staticClass:"pdf-box",style:{width:t.pdfWidth/2+"px"}},t._l(t.page_count,(function(e){return n("div",{key:e,staticClass:"pdfPage_1yRne",style:{width:t.pdfWidth/2+"px",height:t.pdfHeight/2+"px"}},[n("canvas",{staticClass:"pdf-item",style:{width:t.pdfWidth/2+"px",height:t.pdfHeight/2+"px"},attrs:{id:"the-canvas"+e}}),n("div",{staticClass:"dragLayer_3ccsq",attrs:{id:"can"+e}})])})),0),n("div",{staticClass:"bottom-btn"},[n("span",[t._v("页码："),n("input",{directives:[{name:"model",rawName:"v-model",value:t.page_num,expression:"page_num"}],staticClass:"input-text",attrs:{type:"text",placeholder:"1"},domProps:{value:t.page_num},on:{input:function(e){e.target.composing||(t.page_num=e.target.value)}}}),t._v(" / "+t._s(t.page_count)+" ")]),n("el-button",{staticStyle:{"padding-left":"10px"},attrs:{type:"text",size:"mini"},on:{click:function(e){return t.jump(t.page_num,t.attach_id)}}},[t._v("跳转")])],1)])]),n("div",{staticClass:"taskInfoArea_3ThxW"},[n("div",{staticClass:"tab-context"},[n("div",{directives:[{name:"show",rawName:"v-show",value:2==t.activeName,expression:"activeName == 2"}],staticClass:"item"},[n("div",{staticClass:"componentsList_1OIrB"},[n("p",{staticClass:"titleh2_3zdht"},[t._v("模板参数")]),n("el-card",{attrs:{shadow:"never"}},[n("el-form",{directives:[{name:"show",rawName:"v-show",value:!0,expression:"true"}],ref:"queryForm",attrs:{model:t.attachParams,inline:!0}},t._l(t.paramsform,(function(e,a){return n(e.type,{key:e.name,ref:"child",refInFor:!0,tag:"component",attrs:{item:e,number:a},on:{change:t.changeValue}})})),1)],1)],1)])]),n("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.saveParams}},[t._v("保存")]),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.goback}},[t._v("返回")])],1)])])},i=[],c=(n("d3b7"),n("159b"),n("b0c0"),n("4ec9"),n("3ca3"),n("ddb0"),n("30c2")),o=n("9410"),r=n("adc1"),s={components:{String:o["b"],Number:o["a"]},data:function(){return{baseurl:"/prod-api",activeNameLeft:"1",isShow:!1,id:"",hasChoose2:!1,hasChoose:!1,scrollTop:0,activeName:"2",pageNum:1,scale:1,page_num:0,page_count:0,maxscale:2,minscale:.5,pdfWidth:0,pdfHeight:0,contract_info:{},contract_attach:[],attach_id:"",contract_img:[],attach_idArr:"",contract_id:"",paramsform:[],attachParams:{},heights:void 0,widths:void 0,arry:[],visible:!1,statusdict:["保存草稿","签约发起","签约完成","签约终止","签约终止"]}},created:function(){this.contract_id=this.$route.params.id,this.mobile=localStorage.getItem("siteMobile"),this.getAttachParam(),this.getHeights()},mounted:function(){this.$nextTick((function(){this.$refs.pdfBox.addEventListener("scroll",this.handleScroll,!1)}))},watch:{scale:function(t,e){document.querySelectorAll(".mark").forEach((function(n){n.style.left=parseInt(n.style.left)/(e/t)+"px",n.style.top=parseInt(n.style.top)/(e/t)+"px",n.style.height=100*t+"px",n.style.width=100*t+"px"})),document.querySelectorAll(".text_mark").forEach((function(n){n.style.left=parseInt(n.style.left)/(e/t)+"px",n.style.top=parseInt(n.style.top)/(e/t)+"px",n.style.height=28*t+"px",n.style.width=n.offsetWidth/(e/t)+"px"})),document.querySelectorAll(".text_mark2").forEach((function(n){n.style.left=parseInt(n.style.left)/(e/t)+"px",n.style.top=parseInt(n.style.top)/(e/t)+"px",n.style.height=100*t+"px",n.style.width=100*t+"px"}))}},methods:{handelChange:function(t){var e=this;0==this.arry.length&&this.contract_attach.forEach((function(t,n){e.arry.push(t.contractImgList.length)}));var n=0;if(t){for(var a=0;a<t;a++)n+=this.arry[a];this.jump(n+1)}else this.jump(1)},getHeights:function(){var t=document.documentElement.scrollWidth||document.body.scrollWidth;document.documentElement.clientHeight;this.widths=t-360-350-150,this.heights=30*this.widths/21},changeValue:function(t,e){this.$set(this.attachParams,t.name,t.value)},getPic:function(){var t=this;this.isShow=!0,Object(c["d"])(this.contract_id).then((function(e){if(200===e.code){t.contract_attach=e.data,t.attach_id=t.contract_attach[0].id,t.page_count=0;for(var n=0;n<t.contract_attach.length;n++)t.page_count=t.page_count+t.contract_attach[n].contractImgList.length;t.loadFile()}}))},saveParams:function(){var t=this;this.isShow=!0;var e={contractId:this.contract_id,params:this.attachParams};Object(c["a"])(e).then((function(e){if(200===e.code){t.isShow=!1;var n=t.paramsform[0].fillby;"send"==n?t.$router.push("/sign/signviews/"+t.contract_id):Object(c["e"])(t.contract_id).then((function(e){if(200===e.code){var n=e.buttonType;"1"==n?t.$router.push("/sign/editparams/"+t.contract_id):"2"==n?t.$router.push("/sign/send/"+t.contract_id):t.$router.push("/contact/info/infoXq/"+t.contract_id)}}))}}))},getAttachParam:function(){var t=this;Object(c["c"])({contractId:this.contract_id}).then((function(e){200===e.code&&(t.paramsform=e.data,t.getPic())})),Object(r["e"])(this.contract_id).then((function(e){200===e.code&&(t.contract_info=e.data)}))},onSubmit:function(){},handleClick:function(t,e){},handleScroll:function(t){var e=this;this.scrollTop=this.$refs.pdfBox.scrollTop;var n=document.querySelectorAll(".pdfPage_1yRne"),a=[];n.forEach((function(t,n){e.scrollTop>=t.offsetTop&&a.push(n)})),this.page_num=Math.max.apply(null,a)+1},jump:function(t,e){var n=0;this.contract_attach.forEach((function(a,i){a.id!=e?n+=a.contractImgList.length:t=n+t}));var a=this,i=this.page_num-1;if(t&&(i=t-1),i>this.page_count)this.$message.error("请输入有效范围内的数字");else{var c=document.querySelectorAll(".pdfPage_1yRne"),o=c[i].offsetTop,r=this.scrollTop,s=o/30>>0;if(o>r)u();else{var l=r-o;s=l/30>>0,h()}}function u(){r<o?(r+=s,a.$refs.pdfBox.scrollTop=r,setTimeout(u,10)):a.$refs.pdfBox.scrollTop=o}function h(){r>o?(r-=s,a.$refs.pdfBox.scrollTop=r,setTimeout(h,10)):a.$refs.pdfBox.scrollTop=o}},loadFile:function(){var t=this;this.$nextTick((function(){t.pageNum=1,t.page_num=1,t.attach_idArr=new Map;for(var e=0;e<t.contract_attach.length;e++){var n=t.contract_attach[e].contractImgList;t.isShow=!1;for(var a=1;a<=n.length;a++){var i=n[a-1].contractImgUrl,c=n[a-1].seq;t.attach_idArr.set(t.pageNum,t.contract_attach[e].id+"||"+c),t.renderPage(t.pageNum,i),t.pageNum++}}}))},renderPage:function(t,e){var n=document.getElementById("the-canvas"+t),a=n.getContext("2d"),i=new Image;i.onload=function(){a.drawImage(i,0,0,n.width,n.height)},i.src=this.baseurl+e,this.pdfHeight=n.height=2*this.heights,this.pdfWidth=n.width=2*this.widths},goback:function(){var t=this.paramsform[0].fillby;"send"==t?this.$router.push("/sign/signviews/"+this.contract_id):this.$router.go(-1)}}},l=s,u=(n("ba49"),n("0c7c")),h=Object(u["a"])(l,a,i,!1,null,"16ca92fa",null);e["default"]=h.exports}}]);