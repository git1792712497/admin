var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,s=(t,o,a)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[o]=a,n=(e,t)=>{for(var o in t||(t={}))i.call(t,o)&&s(e,o,t[o]);if(a)for(var o of a(t))l.call(t,o)&&s(e,o,t[o]);return e},r=(e,t,o)=>new Promise(((a,i)=>{var l=e=>{try{n(o.next(e))}catch(t){i(t)}},s=e=>{try{n(o.throw(e))}catch(t){i(t)}},n=e=>e.done?a(e.value):Promise.resolve(e.value).then(l,s);n((o=o.apply(e,t)).next())}));import{s as c,a as d,w as m,k as p,f as u,ab as f,o as b,j as y,H as g,E as v,G as h,i as P,n as D,ag as w}from"./index-c5a6c875.js";import{B as j,a as O}from"./index-c9e02f09.js";import{B as M,u as T}from"./useForm-76a4ff23.js";import{g as x}from"./system-54dc9bf1.js";import{a as B,s as F}from"./notice-96969c64.js";import{D as Y,u as k}from"./index-2c15cc4f.js";import{T as I}from"./index-327d6ea5.js";const R=[{title:"标题",dataIndex:"title"},{title:"类型",dataIndex:"category"},{title:"通知日期",dataIndex:"releaseTime"}],S=[{field:"title",label:"通知标题",component:"Input"},{field:"category",label:"通知类型",component:"ApiSelect",componentProps:{api:x,params:{code:"notice"},fieldNames:{label:"dictValue",value:"dictKey"},placeholder:"请选择通知类型"}},{field:"releaseTime",label:"通知日期",component:"RangePicker",componentProps:{showTime:!1,valueFormat:"YYYY-MM-DD HH:mm:ss",style:{width:"100%"}},colProps:{span:8}}],V=[{field:"title",label:"标题",component:"Input",required:!0,colProps:{span:24}},{field:"category",label:"通知类型",component:"ApiSelect",componentProps:{api:x,params:{code:"notice"},fieldNames:{label:"dictValue",value:"dictKey"},placeholder:"请选择通知类型"},required:!0},{field:"releaseTime",label:"通知日期",component:"DatePicker",componentProps:{showTime:!0,valueFormat:"YYYY-MM-DD HH:mm:ss",style:{width:"100%"}},required:!0},{field:"content",label:"内容",component:"Input",colProps:{span:24},slot:"content",required:!0}],_=[{field:"title",label:"标题"},{field:"category",label:"通知类型"},{field:"releaseTime",label:"通知日期"},{field:"content",label:"内容"}];const H=c(d({name:"NoticeModal",components:{BasicModal:j,BasicForm:M,Description:Y,Tinymce:I},emits:["success","register"],setup(e,{emit:a}){const i=m(!0),l=m(!0),s=m(""),[c,{setDescProps:d}]=k({schema:_}),[f,{setFieldsValue:b,resetFields:y,validate:g}]=T({labelWidth:70,schemas:V,showActionButtonGroup:!1,baseColProps:{span:12},actionColOptions:{span:23}}),[v,{setModalProps:h,closeModal:P}]=O((e=>r(this,null,(function*(){if(h({confirmLoading:!0,loading:!0}),y(),l.value=!!(null==e?void 0:e.isUpdate),i.value=!!(null==e?void 0:e.isDetail),!(null==e?void 0:e.add)){const t=yield B({id:e.record.id});t.category=t.category+"",s.value=e.record.id,p(i)?d({data:t}):p(l)&&b(n({},t))}h({confirmLoading:!1,loading:!1})}))));return{noticeModal:v,noticeForm:f,noticeDetail:c,getTitle:u((()=>p(l)?"编辑":"新增")),handleSubmit:function(){return r(this,null,(function*(){try{const r=yield g();h({confirmLoading:!0}),p(l)&&(r.id=s.value),yield F(r),P(),a("success",{isUpdate:p(l),values:(e=n({},r),i={id:s.value},t(e,o(i)))})}finally{h({confirmLoading:!1})}var e,i}))},isUpdate:l,isDetail:i}}}),[["render",function(e,t,o,a,i,l){const s=f("Description"),n=f("Tinymce"),r=f("BasicForm"),c=f("BasicModal");return b(),y(c,w(e.$attrs,{onRegister:e.noticeModal,title:e.getTitle,onOk:e.handleSubmit,showOkBtn:!e.isDetail,width:900}),{default:g((()=>[v(P("div",null,[D(s,{show:"isDetail",size:"middle",onRegister:e.noticeDetail,column:1},null,8,["onRegister"])],512),[[h,e.isDetail]]),v(P("div",null,[D(r,{onRegister:e.noticeForm},{content:g((({model:e,field:t})=>[D(n,{modelValue:e[t],"onUpdate:modelValue":o=>e[t]=o,width:"100%"},null,8,["modelValue","onUpdate:modelValue"])])),_:1},8,["onRegister"])],512),[[h,!e.isDetail]])])),_:1},16,["onRegister","title","onOk","showOkBtn"])}]]),U=Object.freeze(Object.defineProperty({__proto__:null,default:H},Symbol.toStringTag,{value:"Module"}));export{H as N,R as c,U as n,S as s};
