var T=Object.defineProperty,B=Object.defineProperties;var C=Object.getOwnPropertyDescriptors;var d=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var w=(o,t,e)=>t in o?T(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e,b=(o,t)=>{for(var e in t||(t={}))v.call(t,e)&&w(o,e,t[e]);if(d)for(var e of d(t))N.call(t,e)&&w(o,e,t[e]);return o},x=(o,t)=>B(o,C(t));var h=(o,t,e)=>new Promise((n,s)=>{var r=l=>{try{a(e.next(l))}catch(i){s(i)}},c=l=>{try{a(e.throw(l))}catch(i){s(i)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,c);a((e=e.apply(o,t)).next())});import{A as F,D as A,h as D,c as L,F as O,G as V,B as M}from"./element-plus-cbff5993.js";import{r as R,u as y,w as W}from"./xlsx-ec0d7d13.js";import{b as q}from"./lodash-es-ca3eac7d.js";import{g as G}from"./menu-b7fe4809.js";import{g as E,r as H,o as J,ab as P,ac as m,b as g,c as p,X as _,u as U}from"./@vue-f164b9f1.js";import"./lodash-unified-cbbf5a2b.js";import"./lodash-d8f670e1.js";import"./@amap-9fd45ac7.js";import"./@sxzz-ad8bfd58.js";import"./@vueuse-b183cf27.js";import"./@element-plus-296a610a.js";import"./dayjs-f0fd0f9b.js";import"./async-validator-f102eabc.js";import"./@ctrl-43a29356.js";import"./escape-html-12e99df8.js";import"./normalize-wheel-es-c175a4cf.js";import"./vue-4c7ac246.js";import"./@floating-ui-5f39704e.js";import"./memoize-one-0650c7b0.js";import"./pinia-b6a13eed.js";import"./vue-demi-68b8001f.js";import"./axios-226f391c.js";import"./qs-b010a38c.js";import"./side-channel-a082fe58.js";import"./get-intrinsic-5660d814.js";import"./has-symbols-8f82dcae.js";import"./function-bind-22e7ee79.js";import"./has-26d28e02.js";import"./call-bind-75c15918.js";import"./object-inspect-4572ba77.js";import"./preload-helper-41c905a7.js";import"./vue-router-bc8ea068.js";import"./nprogress-57f984c9.js";function X(o,t){const e=new FileReader;return e.readAsArrayBuffer(o),new Promise(n=>{e.onload=s=>{const r=s.target.result,c=R(r,{type:"array"}),a=c.SheetNames[0],l=c.Sheets[a],i=y.sheet_to_json(l);n($(i,t))}})}function $(o,t){const e=[],n=q(t);return o.forEach(s=>{let r={};Object.keys(s).forEach(c=>{n[c]&&(r[n[c]]=s[c])}),e.push(r)}),e}function z(o){if(o)if(/.*[\u4e00-\u9fa5]+.*$/.test(o)){const t=o.match(/[\u4e00-\u9fa5]/g).length,e=o.length-t;return t*2.1+e*1.2}else return o=o.toString(),o.replace(/[\u0391-\uFFE5]/g,"aa").length;else return 4}function I(o,t,e=4){const n={};t["!cols"]=[],o.forEach(s=>{Object.keys(s).forEach(r=>{var a;const c=s[r];n[r]=Math.max((a=n[r])!=null?a:e,z(c))})}),Object.keys(n).forEach(s=>{t["!cols"].push({wch:n[s]})})}function K({data:o,header:t,filename:e="表.xlsx",json2sheetOpts:n={},write2excelOpts:s={bookType:"xlsx"}}){let r=[...o];for(let l in t)t[l]||delete t[l];Object.keys(t).length&&(r=o.map(l=>{let i={};for(let u in t)i[u]=l[u];return i}),r.unshift(t),n.skipHeader=!0);const c=y.json_to_sheet(r,n);I(r,c);const a={SheetNames:[e],Sheets:{[e]:c}};W(a,e,s)}const Q={class:"flex justify-between"},Y={class:"flex justify-between"},Z=E({name:"excel"}),Lt=E(x(b({},Z),{setup(o){const t={title:"菜单标题",icon:"菜单图标",createTime:"创建时间",updateTime:"更新时间"};let e=H([]);G({limit:10}).then(({data:r})=>{e.value=r});const n=c=>h(this,[c],function*({file:r}){console.time("导入时间");const a=yield X(r,t);console.log(a,"导入"),console.timeEnd("导入时间"),e.value.push(...a)}),s=()=>h(this,null,function*(){K({data:e.value,header:t}),console.timeEnd("下载时间")});return(r,c)=>{const a=F,l=A,i=D,u=L,f=O,k=V,j=M;return J(),P(j,{shadow:"hover"},{header:m(()=>[g("nav",Q,[p(i,null,{default:m(()=>[p(l,{"http-request":n,"show-file-list":!1},{trigger:m(()=>[p(a,{type:"primary"},{default:m(()=>[_("excel导入")]),_:1})]),_:1}),p(a,{type:"primary",onClick:s},{default:m(()=>[_("excel导出")]),_:1})]),_:1}),g("div",Y,[p(u,{href:"https://www.npmjs.com/package/xlsx",target:"_blank",type:"primary"},{default:m(()=>[_("excel导入导出")]),_:1})])])]),default:m(()=>[p(k,{data:U(e),"row-key":S=>S.id,border:"","highlight-current-row":"",stripe:""},{default:m(()=>[p(f,{label:"菜单标题",prop:"title","show-overflow-tooltip":"",width:"250"}),p(f,{label:"菜单图标",prop:"icon","show-overflow-tooltip":"",width:"180"}),p(f,{label:"创建时间",prop:"createTime","show-overflow-tooltip":""}),p(f,{label:"更新时间",prop:"updateTime","show-overflow-tooltip":""})]),_:1},8,["data","row-key"])]),_:1})}}}));export{Lt as default};
