import{u as e,B as o}from"./index-c9e02f09.js";import{av as n,s as a,a as i,w as t,W as s,eg as l,ab as p,o as r,j as d,H as c,n as u,k as f,dh as A,ei as M,dy as v,dz as w,i as g}from"./index-c5a6c875.js";import"./useWindowSizeFn-72c85a53.js";import"./FullscreenOutlined-9b414b92.js";import"./isEqual-f9888ec4.js";import"./_baseIsEqual-f0bca653.js";var h={};({get exports(){return h},set exports(e){h=e}}).exports=function(){function e(e){var a=[];return e.AMapUI&&a.push(o(e.AMapUI)),e.Loca&&a.push(n(e.Loca)),Promise.all(a)}function o(e){return new Promise((function(o,n){var i=[];if(e.plugins)for(var p=0;p<e.plugins.length;p+=1)-1==t.AMapUI.plugins.indexOf(e.plugins[p])&&i.push(e.plugins[p]);if(s.AMapUI===a.failed)n("前次请求 AMapUI 失败");else if(s.AMapUI===a.notload){s.AMapUI=a.loading,t.AMapUI.version=e.version||t.AMapUI.version,p=t.AMapUI.version;var r=document.body||document.head,d=document.createElement("script");d.type="text/javascript",d.src="https://webapi.amap.com/ui/"+p+"/main.js",d.onerror=function(e){s.AMapUI=a.failed,n("请求 AMapUI 失败")},d.onload=function(){if(s.AMapUI=a.loaded,i.length)window.AMapUI.loadUI(i,(function(){for(var e=0,n=i.length;e<n;e++){var a=i[e].split("/").slice(-1)[0];window.AMapUI[a]=arguments[e]}for(o();l.AMapUI.length;)l.AMapUI.splice(0,1)[0]()}));else for(o();l.AMapUI.length;)l.AMapUI.splice(0,1)[0]()},r.appendChild(d)}else s.AMapUI===a.loaded?e.version&&e.version!==t.AMapUI.version?n("不允许多个版本 AMapUI 混用"):i.length?window.AMapUI.loadUI(i,(function(){for(var e=0,n=i.length;e<n;e++){var a=i[e].split("/").slice(-1)[0];window.AMapUI[a]=arguments[e]}o()})):o():e.version&&e.version!==t.AMapUI.version?n("不允许多个版本 AMapUI 混用"):l.AMapUI.push((function(e){e?n(e):i.length?window.AMapUI.loadUI(i,(function(){for(var e=0,n=i.length;e<n;e++){var a=i[e].split("/").slice(-1)[0];window.AMapUI[a]=arguments[e]}o()})):o()}))}))}function n(e){return new Promise((function(o,n){if(s.Loca===a.failed)n("前次请求 Loca 失败");else if(s.Loca===a.notload){s.Loca=a.loading,t.Loca.version=e.version||t.Loca.version;var i=t.Loca.version,p=t.AMap.version.startsWith("2"),r=i.startsWith("2");if(p&&!r||!p&&r)n("JSAPI 与 Loca 版本不对应！！");else{p=t.key,r=document.body||document.head;var d=document.createElement("script");d.type="text/javascript",d.src="https://webapi.amap.com/loca?v="+i+"&key="+p,d.onerror=function(e){s.Loca=a.failed,n("请求 AMapUI 失败")},d.onload=function(){for(s.Loca=a.loaded,o();l.Loca.length;)l.Loca.splice(0,1)[0]()},r.appendChild(d)}}else s.Loca===a.loaded?e.version&&e.version!==t.Loca.version?n("不允许多个版本 Loca 混用"):o():e.version&&e.version!==t.Loca.version?n("不允许多个版本 Loca 混用"):l.Loca.push((function(e){e?n(e):n()}))}))}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var a,i;(i=a||(a={})).notload="notload",i.loading="loading",i.loaded="loaded",i.failed="failed";var t={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},s={AMap:a.notload,AMapUI:a.notload,Loca:a.notload},l={AMap:[],AMapUI:[],Loca:[]},p=[],r=function(e){"function"==typeof e&&(s.AMap===a.loaded?e(window.AMap):p.push(e))};return{load:function(o){return new Promise((function(n,i){if(s.AMap==a.failed)i("");else if(s.AMap==a.notload){var l=o.key,d=o.version,c=o.plugins;l?(window.AMap&&"lbs.amap.com"!==location.host&&i("禁止多种API加载方式混用"),t.key=l,t.AMap.version=d||t.AMap.version,t.AMap.plugins=c||t.AMap.plugins,s.AMap=a.loading,d=document.body||document.head,window.___onAPILoaded=function(t){if(delete window.___onAPILoaded,t)s.AMap=a.failed,i(t);else for(s.AMap=a.loaded,e(o).then((function(){n(window.AMap)})).catch(i);p.length;)p.splice(0,1)[0]()},(c=document.createElement("script")).type="text/javascript",c.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+t.AMap.version+"&key="+l+"&plugin="+t.AMap.plugins.join(","),c.onerror=function(e){s.AMap=a.failed,i(e)},d.appendChild(c)):i("请填写key")}else if(s.AMap==a.loaded)if(o.key&&o.key!==t.key)i("多个不一致的 key");else if(o.version&&o.version!==t.AMap.version)i("不允许多个版本 JSAPI 混用");else{if(l=[],o.plugins)for(d=0;d<o.plugins.length;d+=1)-1==t.AMap.plugins.indexOf(o.plugins[d])&&l.push(o.plugins[d]);l.length?window.AMap.plugin(l,(function(){e(o).then((function(){n(window.AMap)})).catch(i)})):e(o).then((function(){n(window.AMap)})).catch(i)}else if(o.key&&o.key!==t.key)i("多个不一致的 key");else if(o.version&&o.version!==t.AMap.version)i("不允许多个版本 JSAPI 混用");else{var u=[];if(o.plugins)for(d=0;d<o.plugins.length;d+=1)-1==t.AMap.plugins.indexOf(o.plugins[d])&&u.push(o.plugins[d]);r((function(){u.length?window.AMap.plugin(u,(function(){e(o).then((function(){n(window.AMap)})).catch(i)})):e(o).then((function(){n(window.AMap)})).catch(i)}))}}))},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,t={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},s={AMap:a.notload,AMapUI:a.notload,Loca:a.notload},l={AMap:[],AMapUI:[],Loca:[]}}}}();const m=h,I=e=>(v("data-v-0fcabfb0"),e=e(),w(),e),y=I((()=>g("span",{class:"ant-modal-title"},"企业地址 : ",-1))),U=I((()=>g("main",{id:"container"},null,-1))),L=a(i({emits:["address"],setup(n,{expose:a,emit:i}){const[v,{openModal:w}]=e();window._AMapSecurityConfig={securityJsCode:"f86c6dbb0585f5df290482f25aee1ed7"};let g,h,I,L,b,k=t(),C=[];s((()=>{return e=this,o=null,n=function*(){b=yield m.load({key:"ca5fdff50eb80a3399c114cde9ebf1cc",version:"2.0",plugins:["AMap.Scale"],Loca:{version:"2.0"}}),h=new b.Map("container",{viewMode:"3D",zoom:5,center:[105.602725,37.076636]}),h.setDefaultCursor("pointer"),h.plugin(["AMap.ToolBar","AMap.Scale","AMap.Geocoder","AMap.Geolocation","AMap.PlaceSearch"],(()=>{h.addControl(new b.ToolBar),h.addControl(new b.Scale),h.addControl(new b.Geolocation({enableHighAccuracy:!0,timeout:1e4,position:"RT",buttonOffset:new b.Pixel(10,20),zoomToAccuracy:!0}))})),I=new b.Geocoder({city:"全国"}),h.on("click",(e=>{const o=e.lnglat.lat,n=e.lnglat.lng;h.setZoomAndCenter(10,[n,o]),I.getAddress([n,o],((e,a)=>{if("complete"===e&&"OK"===a.info){const{addressComponent:e,formattedAddress:t}=a.regeocode;e.detailedAddress=t,e.lng=n,e.lat=o,i("address",e),L=new b.Marker({position:new b.LngLat(n,o)}),h.remove(C),h.add([L]),C.push(L)}}))})),g=new b.PlaceSearch({map:h,city:"",pageSize:30,pageIndex:1,citylimit:!1,autoFitView:!0})},new Promise(((a,i)=>{var t=e=>{try{l(n.next(e))}catch(o){i(o)}},s=e=>{try{l(n.throw(e))}catch(o){i(o)}},l=e=>e.done?a(e.value):Promise.resolve(e.value).then(t,s);l((n=n.apply(e,o)).next())}));var e,o,n}));let x=l([]);const P=e=>{g.search(e,((e,o)=>{if(o&&"object"==typeof o&&o.poiList){const e=o.poiList.pois;e.forEach((e=>{e.value=e.name,e.label=e.name})),x.value=e}}))};function _(e,o){const{lng:n,lat:a}=o.location;i("address",o),h.setZoomAndCenter(10,[n,a])}const S=()=>{I.getLocation(k.value,(function(e,o){if("complete"===e&&"OK"===o.info){const{lat:e,lng:n}=o.geocodes[0].location;h.setZoomAndCenter(12,[n,e]),L=new b.Marker({position:new b.LngLat(n,e)}),h.remove(C),h.add([L]),C.push(L);let a=o.geocodes[0];a.lat=e,a.lng=n,a.province=a.addressComponent.province,a.city=a.addressComponent.city,a.district=a.addressComponent.district,a.township=a.addressComponent.township,a.street=a.addressComponent.township,a.detailedAddress=a.formattedAddress,i("address",a)}}))};return a({openModal:w}),(e,n)=>{const a=p("a-auto-complete"),i=p("a-button");return r(),d(f(o),{forceRender:"",width:"60%",onOk:n[1]||(n[1]=e=>f(w)(!1)),onRegister:f(v)},{title:c((()=>[y,u(a,{allowClear:"",style:{width:"70%"},placeholder:"输入搜索地址 + 关键字",value:f(k),"onUpdate:value":n[0]||(n[0]=e=>A(k)?k.value=e:k=e),"dropdown-match-select-width":252,options:f(x),onSelect:_,onSearch:P},null,8,["value","options"]),u(i,{type:"primary",onClick:S},{default:c((()=>[u(f(M))])),_:1})])),default:c((()=>[U])),_:1},8,["onRegister"])}}}),[["__scopeId","data-v-0fcabfb0"]]);export{L as default};
