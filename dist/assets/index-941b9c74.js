var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,c=(t,n,l)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[n]=l,r=(e,t)=>{for(var n in t||(t={}))a.call(t,n)&&c(e,n,t[n]);if(l)for(var n of l(t))s.call(t,n)&&c(e,n,t[n]);return e},o=(e,l)=>t(e,n(l)),i=(e,t,n)=>new Promise(((l,a)=>{var s=e=>{try{r(n.next(e))}catch(t){a(t)}},c=e=>{try{r(n.throw(e))}catch(t){a(t)}},r=e=>e.done?l(e.value):Promise.resolve(e.value).then(s,c);r((n=n.apply(e,t)).next())}));import{dF as d,dG as u,bL as h,c4 as y,c5 as p,bM as f,dl as v,dq as g,dH as k,dI as b,dJ as m,dK as K,a as x,w as S,dL as L,c as E,f as A,B as C,o as N,h as _,k as T,ad as O,l as B,j as w,H as j,K as I,t as P,ah as D,q as $,n as U,dM as M,O as R,am as H,dN as X,an as Y,ao as F,dO as V,ci as W,bc as q,cp as G,da as J,bH as z,dP as Q,cP as Z,U as ee,dQ as te,W as ne,aa as le,a9 as ae,M as se,a3 as ce,dR as re,dS as oe,ap as ie,x as de,as as ue,b5 as he,aj as ye,ak as pe,dT as fe,d4 as ve,Z as ge,dU as ke,a2 as be,cd as me,E as Ke,G as xe,a7 as Se,b4 as Le,ag as Ee,dV as Ae,dW as Ce,bg as Ne,bw as _e}from"./index-c5a6c875.js";import{g as Te}from"./get-8f9589fb.js";const Oe=v((function(e,t){return g(e)?function(e,t,n,l){var a=-1,s=y,c=!0,r=e.length,o=[],i=t.length;if(!r)return o;n&&(t=d(t,u(n))),l?(s=p,c=!1):t.length>=200&&(s=f,c=!1,t=new h(t));e:for(;++a<r;){var v=e[a],g=null==n?v:n(v);if(v=l||0!==v?v:0,c&&g==g){for(var k=i;k--;)if(t[k]===g)continue e;o.push(v)}else s(t,g,l)||o.push(v)}return o}(e,k(t,1,g,!0)):[]}));function Be(e,t){return t?"string"==typeof t?` ${e}--${t}`:Array.isArray(t)?t.reduce(((t,n)=>t+Be(e,n)),""):Object.keys(t).reduce(((n,l)=>n+(t[l]?Be(e,l):"")),""):""}function we(e){return(t,n)=>(t&&"string"!=typeof t&&(n=t,t=""),`${t=t?`${e}__${t}`:e}${Be(t,n)}`)}function je(e){return[we(`${b}-${e}`)]}const Ie=Symbol(),Pe=Symbol();function De(e,t){if(!m(e)||e[Pe])return e;const{values:n,required:l,default:a,type:s,validator:c}=e,r=n||c?e=>{let l=!1,s=[];if(n&&(s=[...n,a],l||(l=s.includes(e))),c&&(l||(l=c(e))),!l&&s.length>0){const n=[...new Set(s)].map((e=>JSON.stringify(e))).join(", ");K(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${n}], got value ${JSON.stringify(e)}.`)}return l}:void 0;return{type:"object"==typeof s&&Object.getOwnPropertySymbols(s).includes(Ie)?s[Ie]:s,required:!!l,default:a,validator:r,[Pe]:!0}}var $e=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))($e||{});const Ue=(Me={value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:Array,default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1},treeWrapperClassName:String},function(e){for(var t=-1,n=null==e?0:e.length,l={};++t<n;){var a=e[t];l[a[0]]=a[1]}return l}(Object.entries(Me).map((([e,t])=>[e,De(t,e)]))));var Me;const Re={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},He=x({props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search"],setup(e,{emit:t}){const n=e,l=S(""),[a]=je("tree-header"),s=L(),{t:c}=E(),r=A((()=>["mr-1","w-full",{"ml-5":s.headerTitle||n.title}])),o=A((()=>{const{checkable:e}=n,t=[{label:c("component.tree.expandAll"),value:$e.EXPAND_ALL},{label:c("component.tree.unExpandAll"),value:$e.UN_EXPAND_ALL,divider:e}];return e?[{label:c("component.tree.selectAll"),value:$e.SELECT_ALL},{label:c("component.tree.unSelectAll"),value:$e.UN_SELECT_ALL,divider:e},...t,{label:c("component.tree.checkStrictly"),value:$e.CHECK_STRICTLY},{label:c("component.tree.checkUnStrictly"),value:$e.CHECK_UN_STRICTLY}]:t}));function i(e){var l,a,s,c;const{key:r}=e;switch(r){case $e.SELECT_ALL:null==(l=n.checkAll)||l.call(n,!0);break;case $e.UN_SELECT_ALL:null==(a=n.checkAll)||a.call(n,!1);break;case $e.EXPAND_ALL:null==(s=n.expandAll)||s.call(n,!0);break;case $e.UN_EXPAND_ALL:null==(c=n.expandAll)||c.call(n,!1);break;case $e.CHECK_STRICTLY:t("strictly-change",!1);break;case $e.CHECK_UN_STRICTLY:t("strictly-change",!0)}}const d=z((function(e){t("search",e)}),200);return C((()=>l.value),(e=>{d(e)})),C((()=>n.searchText),(e=>{e!==l.value&&(l.value=e)})),(e,t)=>(N(),_("div",{class:$([T(a)(),"flex px-2 py-1.5 items-center"])},[T(s).headerTitle?O(e.$slots,"headerTitle",{key:0}):B("",!0),!T(s).headerTitle&&e.title?(N(),w(T(D),{key:1,helpMessage:e.helpMessage},{default:j((()=>[I(P(e.title),1)])),_:1},8,["helpMessage"])):B("",!0),e.search||e.toolbar?(N(),_("div",Re,[e.search?(N(),_("div",{key:0,class:$(T(r))},[U(T(M),{placeholder:T(c)("common.searchText"),size:"small",allowClear:"",value:l.value,"onUpdate:value":t[0]||(t[0]=e=>l.value=e)},null,8,["placeholder","value"])],2)):B("",!0),e.toolbar?(N(),w(T(J),{key:1,onClick:t[1]||(t[1]=G((()=>{}),["prevent"]))},{overlay:j((()=>[U(T(W),{onClick:i},{default:j((()=>[(N(!0),_(R,null,H(T(o),(e=>(N(),_(R,{key:e.value},[U(T(X),Y(F({key:e.value})),{default:j((()=>[I(P(e.label),1)])),_:2},1040),e.divider?(N(),w(T(V),{key:0})):B("",!0)],64)))),128))])),_:1})])),default:j((()=>[U(T(q),{icon:"ion:ellipsis-vertical"})])),_:1})):B("",!0)])):B("",!0)],2))}}),Xe=({icon:e})=>e?Q(e)?Z(q,{icon:e,class:"mr-1"}):q:null;const Ye={width:{type:Number,default:156},customEvent:{type:Object,default:null},styles:{type:Object},showIcon:{type:Boolean,default:!0},axis:{type:Object,default:()=>({x:0,y:0})},items:{type:Array,default:()=>[]}},Fe=e=>{const{item:t}=e;return U("span",{style:"display: inline-block; width: 100%; ",class:"px-4",onClick:e.handler.bind(null,t)},[e.showIcon&&t.icon&&U(q,{class:"mr-2",icon:t.icon},null),U("span",null,[t.label])])},Ve=x({name:"ContextMenu",props:Ye,setup(e){const t=S(null),n=S(!1),l=A((()=>{const{axis:t,items:n,styles:l,width:a}=e,{x:s,y:c}=t||{x:0,y:0},i=40*(n||[]).length,d=a,u=document.body,h=u.clientWidth<s+d?s-d:s,y=u.clientHeight<c+i?c-i:c;return o(r({},l),{position:"absolute",width:`${a}px`,left:`${h+1}px`,top:`${y+1}px`,zIndex:9999})}));function a(e,t){const{handler:l,disabled:a}=e;a||(n.value=!1,null==t||t.stopPropagation(),null==t||t.preventDefault(),null==l||l())}function s(t){return t.filter((e=>!e.hidden)).map((t=>{const{disabled:l,label:c,children:r,divider:o=!1}=t,i={item:t,handler:a,showIcon:e.showIcon};return r&&0!==r.length?T(n)?U(W.SubMenu,{key:c,disabled:l,popupClassName:"context-menu__popup"},{title:()=>U(Fe,i,null),default:()=>s(r)}):null:U(R,null,[U(W.Item,{disabled:l,class:"context-menu__item",key:c},{default:()=>[U(Fe,i,null)]}),o?U(se,{key:`d-${c}`},null):null])}))}return ne((()=>{le((()=>n.value=!0))})),ae((()=>{const e=T(t);e&&document.body.removeChild(e)})),()=>{let a;if(!T(n))return null;const{items:c}=e;return U("div",{class:"context-menu"},[U(W,{inlineIndent:12,mode:"vertical",ref:t,style:T(l)},(r=a=s(c),"function"==typeof r||"[object Object]"===Object.prototype.toString.call(r)&&!ce(r)?a:{default:()=>[a]}))]);var r}}}),We={domList:[],resolve:()=>{}},qe=function(e){const{event:t}=e||{};if(t&&(null==t||t.preventDefault()),re)return new Promise((n=>{const l=document.body,a=document.createElement("div"),s={};e.styles&&(s.styles=e.styles),e.items&&(s.items=e.items),e.event&&(s.customEvent=t,s.axis={x:t.clientX,y:t.clientY});const c=U(Ve,s);oe(c,a);const r=function(){We.resolve("")};We.domList.push(a);const o=function(){We.domList.forEach((e=>{try{e&&l.removeChild(e)}catch(t){}})),l.removeEventListener("click",r),l.removeEventListener("scroll",r)};We.resolve=function(e){o(),n(e)},o(),l.appendChild(a),l.addEventListener("click",r),l.addEventListener("scroll",r)}))},Ge=function(){We&&(We.resolve(""),We.domList=[])};const Je=x({name:"BasicTree",inheritAttrs:!1,props:Ue,emits:["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],setup(e,{attrs:t,slots:n,emit:l,expose:a}){const[s]=je("tree"),c=de({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),d=de({startSearch:!1,searchText:"",searchData:[]}),u=S([]),[h]=function(e=!0){return ie()&&e&&ae((()=>{Ge()})),[qe,Ge]}(),y=A((()=>{const{fieldNames:t}=e;return r({children:"children",title:"title",key:"key"},t)})),p=A((()=>{let n=o(r(r({blockNode:!0},t),e),{expandedKeys:c.expandedKeys,selectedKeys:c.selectedKeys,checkedKeys:c.checkedKeys,checkStrictly:c.checkStrictly,fieldNames:T(y),"onUpdate:expandedKeys":e=>{c.expandedKeys=e,l("update:expandedKeys",e)},"onUpdate:selectedKeys":e=>{c.selectedKeys=e,l("update:selectedKeys",e)},onCheck:(e,t)=>{let n=ue(c.checkedKeys);if(he(n)&&d.startSearch){const e=t.node.eventKey;n=Oe(n,L(e)),t.checked&&n.push(e),c.checkedKeys=n}else c.checkedKeys=e;const a=ue(c.checkedKeys);l("update:value",a),l("check",a,t)},onRightClick:_});return ye(n,"treeData","class")})),f=A((()=>d.startSearch?d.searchData:T(u))),v=A((()=>!f.value||0===f.value.length)),{deleteNodeByKey:g,insertNodeByKey:k,insertNodesByKey:b,filterByLevel:m,updateNodeByKey:K,getAllKeys:x,getChildrenKeys:L,getEnabledKeys:E,getSelectedNode:N}=function(e,t){function n(l){const a=[],s=l||T(e),{key:c,children:r}=T(t);if(!r||!c)return a;for(let e=0;e<s.length;e++){const t=s[e];a.push(t[c]);const l=t[r];l&&l.length&&a.push(...n(l))}return a}return{deleteNodeByKey:function n(l,a){if(!l)return;const s=a||T(e),{key:c,children:r}=T(t);if(r&&c)for(let e=0;e<s.length;e++){const t=s[e],a=t[r];if(t[c]===l){s.splice(e,1);break}a&&a.length&&n(l,t[r])}},insertNodeByKey:function({parentKey:n=null,node:l,push:a="push"}){const s=ee(T(e));if(!n)return s[a](l),void(e.value=s);const{key:c,children:r}=T(t);r&&c&&(te(s,(e=>{if(e[c]===n)return e[r]=e[r]||[],e[r][a](l),!0})),e.value=s)},insertNodesByKey:function({parentKey:n=null,list:l,push:a="push"}){const s=ee(T(e));if(l&&!(l.length<1))if(n){const{key:c,children:r}=T(t);if(!r||!c)return;te(s,(t=>{if(t[c]===n){t[r]=t[r]||[];for(let e=0;e<l.length;e++)t[r][a](l[e]);return e.value=s,!0}}))}else for(let e=0;e<l.length;e++)s[a](l[e])},filterByLevel:function n(l=1,a,s=1){if(!l)return[];const c=[],r=a||T(e)||[];for(let e=0;e<r.length;e++){const a=r[e],{key:o,children:i}=T(t),d=o?a[o]:"",u=i?a[i]:[];c.push(d),u&&u.length&&s<l&&(s+=1,c.push(...n(l,u,s)))}return c},updateNodeByKey:function n(l,a,s){if(!l)return;const c=s||T(e),{key:o,children:i}=T(t);if(i&&o)for(let e=0;e<c.length;e++){const t=c[e],s=t[i];if(t[o]===l){c[e]=r(r({},c[e]),a);break}s&&s.length&&n(l,a,t[i])}},getAllKeys:n,getChildrenKeys:function l(a,s){const c=[],r=s||T(e),{key:o,children:i}=T(t);if(!i||!o)return c;for(let e=0;e<r.length;e++){const t=r[e],s=t[i];a===t[o]?(c.push(t[o]),s&&s.length&&c.push(...n(s))):s&&s.length&&c.push(...l(a,s))}return c},getEnabledKeys:function n(l){const a=[],s=l||T(e),{key:c,children:r}=T(t);if(!r||!c)return a;for(let e=0;e<s.length;e++){const t=s[e];!0!==t.disabled&&!1!==t.selectable&&a.push(t[c]);const l=t[r];l&&l.length&&a.push(...n(l))}return a},getSelectedNode:function t(n,l,a){return n||0===n?((l||T(e)).forEach((e=>{if((null==a?void 0:a.key)||0===(null==a?void 0:a.key))return a;e.key!==n?e.children&&e.children.length&&(a=t(n,e.children,a)):a=e})),a||null):null}}}(u,y);function _(t){return i(this,arguments,(function*({event:t,node:n}){var l;const{rightMenuList:a=[],beforeRightClick:s}=e;let c={event:t,items:[]};if(s&&pe(s)){let e=yield s(n,t);Array.isArray(e)?c.items=e:Object.assign(c,e)}else c.items=a;(null==(l=c.items)?void 0:l.length)&&(c.items=c.items.filter((e=>!e.hidden)),h(c))}))}function O(e){c.expandedKeys=e}function B(e){c.selectedKeys=e}function w(e){c.checkedKeys=e}function j(e){c.checkedKeys=e?E():[]}function I(e){c.expandedKeys=e?x():[]}function P(e){c.checkStrictly=e}function D(t){if(t!==d.searchText&&(d.searchText=t),l("update:searchValue",t),!t)return void(d.startSearch=!1);const{filterFn:n,checkable:a,expandOnSearch:s,checkOnSearch:c,selectedOnSearch:r}=T(e);d.startSearch=!0;const{title:o,key:i}=T(y),h=[];if(d.searchData=fe(T(u),(e=>{var l,a;const s=n?n(t,e,T(y)):null!=(a=null==(l=e[o])?void 0:l.includes(t))&&a;return s&&h.push(e[i]),s}),T(y)),s){const e=ve(d.searchData).map((e=>e[i]));e&&e.length&&O(e)}c&&a&&h.length&&w(h),r&&h.length&&B(h)}function $(t,n){if(e.clickRowToExpand&&n&&0!==n.length)if(c.expandedKeys.includes(t)){const e=[...c.expandedKeys],n=e.findIndex((e=>e===t));-1!==n&&e.splice(n,1),O(e)}else O([...c.expandedKeys,t])}C((()=>e.searchValue),(e=>{e!==d.searchText&&(d.searchText=e)}),{immediate:!0}),C((()=>e.treeData),(e=>{e&&D(d.searchText)})),ge((()=>{u.value=e.treeData})),ne((()=>{const t=parseInt(e.defaultExpandLevel);t>0?c.expandedKeys=m(t):e.defaultExpandAll&&I(!0)})),ge((()=>{c.expandedKeys=e.expandedKeys})),ge((()=>{c.selectedKeys=e.selectedKeys})),ge((()=>{c.checkedKeys=e.checkedKeys})),C((()=>e.value),(()=>{c.checkedKeys=ue(e.value||[])}),{immediate:!0}),C((()=>c.checkedKeys),(()=>{const e=ue(c.checkedKeys);l("update:value",e),l("change",e)})),ge((()=>{c.checkStrictly=e.checkStrictly}));const M={setExpandedKeys:O,getExpandedKeys:function(){return c.expandedKeys},setSelectedKeys:B,getSelectedKeys:function(){return c.selectedKeys},setCheckedKeys:w,getCheckedKeys:function(){return c.checkedKeys},insertNodeByKey:k,insertNodesByKey:b,deleteNodeByKey:g,updateNodeByKey:K,getSelectedNode:N,checkAll:j,expandAll:I,filterByLevel:e=>{c.expandedKeys=m(e)},setSearchValue:e=>{D(e)},getSearchValue:()=>d.searchText};function H(t){const{actionList:n}=e;if(n&&0!==n.length)return n.map(((e,n)=>{var l;let a=!0;return pe(e.show)?a=null==(l=e.show)?void 0:l.call(e,t):Ne(e.show)&&(a=e.show),a?U("span",{key:n,class:s("action")},[e.render(t)]):null}))}const X=A((()=>{const t=ee(f.value);return ke(t,((t,l)=>{var a;const c=d.searchText,{highlight:r}=T(e),{title:o,key:i,children:u}=T(y),h=function(t,n){return!n&&e.renderIcon&&pe(e.renderIcon)?e.renderIcon(t):n}(t,t.icon),f=Te(t,o),v=c?f.indexOf(c):-1,g=d.startSearch&&!Ce(c)&&r&&-1!==v,k=`color: ${Ne(r)?"#f50":r}`,b=g?U("span",{class:(null==(a=T(p))?void 0:a.blockNode)?`${s("content")}`:""},[U("span",null,[f.substr(0,v)]),U("span",{style:k},[c]),U("span",null,[f.substr(v+c.length)])]):f;return t[o]=U("span",{class:`${s("title")} pl-2`,onClick:$.bind(null,t[i],t[u])},[(null==n?void 0:n.title)?_e(n,"title",t):U(R,null,[h&&U(Xe,{icon:h},null),b,U("span",{class:s("actions")},[H(t)])])]),t})),t}));return a(M),()=>{let l;const{title:a,helpMessage:c,toolbar:r,search:o,checkable:i}=e,u=a||r||o||n.headerTitle,h={height:"calc(100% - 38px)"};return U("div",{class:[s(),"h-full",t.class]},[u&&U(He,{checkable:i,checkAll:j,expandAll:I,title:a,search:o,toolbar:r,helpMessage:c,onStrictlyChange:P,onSearch:D,searchText:d.searchText},(y=l=be(n),"function"==typeof y||"[object Object]"===Object.prototype.toString.call(y)&&!ce(y)?l:{default:()=>[l]})),U(me,{wrapperClassName:T(e.treeWrapperClassName),spinning:T(e.loading),tip:"加载中..."},{default:()=>[Ke(U(Se,{style:h},{default:()=>[U(Le,Ee(T(p),{showIcon:!1,treeData:X.value}),null)]}),[[xe,!T(v)]]),Ke(U(Ae,{image:Ae.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[xe,T(v)]])]})]);var y}}});export{Je as _};
