var e=Object.defineProperty,t=Object.defineProperties,l=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,r=(t,l,n)=>l in t?e(t,l,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[l]=n,s=(e,t)=>{for(var l in t||(t={}))o.call(t,l)&&r(e,l,t[l]);if(n)for(var l of n(t))a.call(t,l)&&r(e,l,t[l]);return e},i=(e,n)=>t(e,l(n)),c=(e,t,l)=>new Promise(((n,o)=>{var a=e=>{try{s(l.next(e))}catch(t){o(t)}},r=e=>{try{s(l.throw(e))}catch(t){o(t)}},s=e=>e.done?n(e.value):Promise.resolve(e.value).then(a,r);s((l=l.apply(e,t)).next())}));import{n as u,r as d,c as p,Z as f,k as g,$ as m,a as h,a0 as b,a1 as y,a2 as v,a3 as C,a4 as O,a5 as H,a6 as M,a7 as k,w as F,a8 as S,f as B,B as P,W as w,a9 as x,aa as j,s as T,ab as W,ac as $,o as N,j as R,H as E,E as A,h as L,ad as _,ae as V,af as D,b as I,O as q,l as z,q as Y,K as X,t as K,ag as Z,ah as G,ai as J,aj as Q,ak as U,al as ee,am as te,an as le,ao as ne,ap as oe,aq as ae,x as re,ar as se,as as ie,at as ce,au as ue,Y as de}from"./index-c5a6c875.js";import{u as pe}from"./useWindowSizeFn-72c85a53.js";import{F as fe,a as ge}from"./FullscreenOutlined-9b414b92.js";import{i as me}from"./isEqual-f9888ec4.js";const he={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 00203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z"}}]},name:"close",theme:"outlined"};function be(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?Object(arguments[t]):{},n=Object.keys(l);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(l).filter((function(e){return Object.getOwnPropertyDescriptor(l,e).enumerable})))),n.forEach((function(t){ye(e,t,l[t])}))}return e}function ye(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}var ve=function(e,t){var l=be({},e,t.attrs);return u(d,be({},l,{icon:he}),null)};ve.displayName="CloseOutlined",ve.inheritAttrs=!1;const Ce=ve,{t:Oe}=p(),He={visible:{type:Boolean},scrollTop:{type:Boolean,default:!0},height:{type:Number},minHeight:{type:Number},draggable:{type:Boolean,default:!0},centered:{type:Boolean},cancelText:{type:String,default:Oe("common.cancelText")},okText:{type:String,default:Oe("common.okText")},closeFunc:Function},Me=Object.assign({},He,{defaultFullscreen:{type:Boolean},canFullscreen:{type:Boolean,default:!0},wrapperFooterOffset:{type:Number,default:0},helpMessage:[String,Array],useWrapper:{type:Boolean,default:!0},loading:{type:Boolean},loadingTip:{type:String},showCancelBtn:{type:Boolean,default:!0},showOkBtn:{type:Boolean,default:!0},wrapperProps:Object,afterClose:Function,bodyStyle:Object,closable:{type:Boolean,default:!0},closeIcon:Object,confirmLoading:{type:Boolean},destroyOnClose:{type:Boolean},footer:Object,getContainer:Function,mask:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0},keyboard:{type:Boolean,default:!0},maskStyle:Object,okType:{type:String,default:"primary"},okButtonProps:Object,cancelButtonProps:Object,title:{type:String},visible:{type:Boolean},width:[String,Number],wrapClassName:{type:String},zIndex:{type:Number}});function ke(e){const t=(e,t)=>getComputedStyle(e)[t],l=l=>{if(!l)return;l.setAttribute("data-drag",g(e.draggable));const n=l.querySelector(".ant-modal-header"),o=l.querySelector(".ant-modal");n&&o&&g(e.draggable)&&(n.style.cursor="move",n.onmousedown=e=>{if(!e)return;const l=e.clientX,n=e.clientY,a=document.body.clientWidth,r=document.documentElement.clientHeight,s=o.offsetWidth,i=o.offsetHeight,c=o.offsetLeft,u=a-o.offsetLeft-s,d=o.offsetTop,p=r-o.offsetTop-i,f=t(o,"left"),g=t(o,"top");let m=+f,h=+g;f.includes("%")?(m=+document.body.clientWidth*(+f.replace(/%/g,"")/100),h=+document.body.clientHeight*(+g.replace(/%/g,"")/100)):(m=+f.replace(/px/g,""),h=+g.replace(/px/g,"")),document.onmousemove=function(e){let t=e.clientX-l,a=e.clientY-n;-t>c?t=-c:t>u&&(t=u),-a>d?a=-d:a>p&&(a=p),o.style.cssText+=`;left:${t+m}px;top:${a+h}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})};f((()=>{g(e.visible)&&g(e.draggable)&&m((()=>{(()=>{const n=document.querySelectorAll(".ant-modal-wrap");for(const o of Array.from(n)){if(!o)continue;const n=t(o,"display"),a=o.getAttribute("data-drag");"none"!==n&&(null===a||g(e.destroyOnClose))&&l(o)}})()}),30)}))}const Fe=h({name:"Modal",inheritAttrs:!1,props:Me,emits:["cancel"],setup(e,{slots:t,emit:l}){const{visible:n,draggable:o,destroyOnClose:a}=b(e),r=y();ke({visible:n,destroyOnClose:a,draggable:o});const c=e=>{l("cancel",e)};return()=>{let l;const n=i(s(s({},g(r)),e),{onCancel:c});return u(O,n,"function"==typeof(o=l=v(t))||"[object Object]"===Object.prototype.toString.call(o)&&!C(o)?l:{default:()=>[l]});var o}}}),Se=Symbol();function Be(){return M(Se)}const Pe=h({name:"ModalWrapper",components:{ScrollContainer:k},inheritAttrs:!1,props:{loading:{type:Boolean},useWrapper:{type:Boolean,default:!0},modalHeaderHeight:{type:Number,default:57},modalFooterHeight:{type:Number,default:74},minHeight:{type:Number,default:200},height:{type:Number},footerOffset:{type:Number,default:0},visible:{type:Boolean},fullScreen:{type:Boolean},loadingTip:{type:String}},emits:["height-change","ext-height"],setup(e,{emit:t}){const l=F(null),n=F(null),o=F(0),a=F(0);let r=0;pe(i.bind(null,!1)),S(n,(()=>{i()}),{attributes:!0,subtree:!0}),H({redoModalHeight:i},Se);const s=B((()=>({minHeight:`${e.minHeight}px`,[e.fullScreen?"height":"maxHeight"]:`${g(o)}px`})));function i(){return c(this,null,(function*(){if(!e.visible)return;const a=g(l);if(!a)return;const s=a.$el.parentElement;if(s){s.style.padding="0",yield j();try{const l=s.parentElement&&s.parentElement.parentElement;if(!l)return;const a=getComputedStyle(l).top,i=Number.parseInt(a);let c=window.innerHeight-2*i+(e.footerOffset||0)-e.modalFooterHeight-e.modalHeaderHeight;i<40&&(c-=26),yield j();const u=g(n);if(!u)return;yield j(),r=u.scrollHeight,e.fullScreen?o.value=window.innerHeight-e.modalFooterHeight-e.modalHeaderHeight-28:o.value=e.height?e.height:r>c?c:r,t("height-change",g(o))}catch(i){}}}))}return f((()=>{e.useWrapper&&i()})),P((()=>e.fullScreen),(e=>{i(),e?a.value=o.value:o.value=a.value})),w((()=>{const{modalHeaderHeight:l,modalFooterHeight:n}=e;t("ext-height",l+n)})),x((()=>{})),{wrapperRef:l,spinRef:n,spinStyle:s,scrollTop:function(){return c(this,null,(function*(){j((()=>{var e;const t=g(l);t&&(null==(e=null==t?void 0:t.scrollTo)||e.call(t,0))}))}))},setModalHeight:i}}}),we=["loading-tip"];const xe=T(Pe,[["render",function(e,t,l,n,o,a){const r=W("ScrollContainer"),s=$("loading");return N(),R(r,{ref:"wrapperRef"},{default:E((()=>[A((N(),L("div",{ref:"spinRef",style:V(e.spinStyle),"loading-tip":e.loadingTip},[_(e.$slots,"default")],12,we)),[[s,e.loading]])])),_:3},512)}]]);const je=T(h({name:"ModalClose",components:{Tooltip:D,FullscreenExitOutlined:fe,FullscreenOutlined:ge,CloseOutlined:Ce},props:{canFullscreen:{type:Boolean,default:!0},fullScreen:{type:Boolean}},emits:["cancel","fullscreen"],setup(e,{emit:t}){const{prefixCls:l}=I("basic-modal-close"),{t:n}=p();return{t:n,getClass:B((()=>[l,`${l}--custom`,{[`${l}--can-full`]:e.canFullscreen}])),prefixCls:l,handleCancel:function(e){t("cancel",e)},handleFullScreen:function(e){null==e||e.stopPropagation(),null==e||e.preventDefault(),t("fullscreen")}}}}),[["render",function(e,t,l,n,o,a){const r=W("FullscreenExitOutlined"),s=W("Tooltip"),i=W("FullscreenOutlined"),c=W("CloseOutlined");return N(),L("div",{class:Y(e.getClass)},[e.canFullscreen?(N(),L(q,{key:0},[e.fullScreen?(N(),R(s,{key:0,title:e.t("component.modal.restore"),placement:"bottom"},{default:E((()=>[u(r,{role:"full",onClick:e.handleFullScreen},null,8,["onClick"])])),_:1},8,["title"])):(N(),R(s,{key:1,title:e.t("component.modal.maximize"),placement:"bottom"},{default:E((()=>[u(i,{role:"close",onClick:e.handleFullScreen},null,8,["onClick"])])),_:1},8,["title"]))],64)):z("",!0),u(s,{title:e.t("component.modal.close"),placement:"bottom"},{default:E((()=>[u(c,{onClick:e.handleCancel},null,8,["onClick"])])),_:1},8,["title"])],2)}]]);const Te=T(h({name:"BasicModalFooter",props:Me,emits:["ok","cancel"],setup:(e,{emit:t})=>({handleOk:function(e){t("ok",e)},handleCancel:function(e){t("cancel",e)}})}),[["render",function(e,t,l,n,o,a){const r=W("a-button");return N(),L("div",null,[_(e.$slots,"insertFooter"),e.showCancelBtn?(N(),R(r,Z({key:0},e.cancelButtonProps,{onClick:e.handleCancel}),{default:E((()=>[X(K(e.cancelText),1)])),_:1},16,["onClick"])):z("",!0),_(e.$slots,"centerFooter"),e.showOkBtn?(N(),R(r,Z({key:1,type:e.okType,onClick:e.handleOk,loading:e.confirmLoading},e.okButtonProps),{default:E((()=>[X(K(e.okText),1)])),_:1},16,["type","onClick","loading"])):z("",!0),_(e.$slots,"appendFooter")])}]]),We=h({name:"BasicModalHeader",components:{BasicTitle:G},props:{helpMessage:{type:[String,Array]},title:{type:String}},emits:["dblclick"]});const $e=T(h({name:"BasicModal",components:{Modal:Fe,ModalWrapper:xe,ModalClose:je,ModalFooter:Te,ModalHeader:T(We,[["render",function(e,t,l,n,o,a){const r=W("BasicTitle");return N(),R(r,{helpMessage:e.helpMessage},{default:E((()=>[X(K(e.title),1)])),_:1},8,["helpMessage"])}]])},inheritAttrs:!1,props:Me,emits:["visible-change","height-change","cancel","ok","register","update:visible"],setup(e,{emit:t,attrs:l}){const n=F(!1),o=F(null),a=F(null),{prefixCls:r}=I("basic-modal"),u=F(0),d={setModalProps:function(e){o.value=ae(g(o)||{},e),Reflect.has(e,"visible")&&(n.value=!!e.visible);Reflect.has(e,"defaultFullscreen")&&(y.value=!!e.defaultFullscreen)},emitVisible:void 0,redoModalHeight:()=>{j((()=>{g(a)&&g(a).setModalHeight()}))}},p=oe();p&&t("register",d,p.uid);const m=B((()=>s(s({},e),g(o)))),{handleFullScreen:h,getWrapClassName:b,fullScreenRef:y}=function(e){const t=F(!1);return{getWrapClassName:B((()=>{const l=g(e.wrapClassName)||"";return g(t)?`fullscreen-modal ${l} `:g(l)})),handleFullScreen:function(e){e&&e.stopPropagation(),t.value=!g(t)},fullScreenRef:t}}({modalWrapperRef:a,extHeightRef:u,wrapClassName:J(m.value,"wrapClassName")}),v=B((()=>{const e=i(s({},g(m)),{visible:g(n),okButtonProps:void 0,cancelButtonProps:void 0,title:void 0});return i(s({},e),{wrapClassName:g(b)})})),C=B((()=>{const e=i(s(s({},l),g(m)),{visible:g(n),wrapClassName:g(b)});return g(y)?Q(e,["height","title"]):Q(e,"title")})),O=B((()=>{if(!g(y))return g(v).height}));return f((()=>{n.value=!!e.visible,y.value=!!e.defaultFullscreen})),P((()=>g(n)),(l=>{var n;t("visible-change",l),t("update:visible",l),p&&(null==(n=d.emitVisible)||n.call(d,l,p.uid)),j((()=>{e.scrollTop&&l&&g(a)&&g(a).scrollTop()}))}),{immediate:!1}),{handleCancel:function(l){return c(this,null,(function*(){var o,a;if(null==l||l.stopPropagation(),!(null==(a=null==(o=l.target)?void 0:o.classList)?void 0:a.contains(r+"-close--custom")))if(e.closeFunc&&U(e.closeFunc)){const t=yield e.closeFunc();n.value=!t}else n.value=!1,t("cancel",l)}))},getBindValue:C,getProps:v,handleFullScreen:h,fullScreenRef:y,getMergeProps:m,handleOk:function(e){t("ok",e)},visibleRef:n,omit:Q,modalWrapperRef:a,handleExtHeight:function(e){u.value=e},handleHeightChange:function(e){t("height-change",e)},handleTitleDbClick:function(t){e.canFullscreen&&(t.stopPropagation(),h(t))},getWrapperHeight:O}}}),[["render",function(e,t,l,n,o,a){const r=W("ModalClose"),s=W("ModalHeader"),i=W("ModalFooter"),c=W("ModalWrapper"),d=W("Modal");return N(),R(d,Z(e.getBindValue,{onCancel:e.handleCancel}),ee({default:E((()=>[u(c,Z({useWrapper:e.getProps.useWrapper,footerOffset:e.wrapperFooterOffset,fullScreen:e.fullScreenRef,ref:"modalWrapperRef",loading:e.getProps.loading,"loading-tip":e.getProps.loadingTip,minHeight:e.getProps.minHeight,height:e.getWrapperHeight,visible:e.visibleRef,modalFooterHeight:void 0===e.footer||e.footer?void 0:0},e.omit(e.getProps.wrapperProps,"visible","height","modalFooterHeight"),{onExtHeight:e.handleExtHeight,onHeightChange:e.handleHeightChange}),{default:E((()=>[_(e.$slots,"default")])),_:3},16,["useWrapper","footerOffset","fullScreen","loading","loading-tip","minHeight","height","visible","modalFooterHeight","onExtHeight","onHeightChange"])])),_:2},[e.$slots.closeIcon?void 0:{name:"closeIcon",fn:E((()=>[u(r,{canFullscreen:e.getProps.canFullscreen,fullScreen:e.fullScreenRef,onCancel:e.handleCancel,onFullscreen:e.handleFullScreen},null,8,["canFullscreen","fullScreen","onCancel","onFullscreen"])]))},e.$slots.title?void 0:{name:"title",fn:E((()=>[u(s,{helpMessage:e.getProps.helpMessage,title:e.getMergeProps.title,onDblclick:e.handleTitleDbClick},null,8,["helpMessage","title","onDblclick"])]))},e.$slots.footer?void 0:{name:"footer",fn:E((()=>[u(i,Z(e.getBindValue,{onOk:e.handleOk,onCancel:e.handleCancel}),ee({_:2},[te(Object.keys(e.$slots),(t=>({name:t,fn:E((l=>[_(e.$slots,t,le(ne(l||{})))]))})))]),1040,["onOk","onCancel"])]))},te(Object.keys(e.omit(e.$slots,"default")),(t=>({name:t,fn:E((l=>[_(e.$slots,t,le(ne(l||{})))]))})))]),1040,["onCancel"])}]]),Ne=re({}),Re=re({});function Ee(){const e=F(null),t=F(!1),l=F("");const n=()=>{const t=g(e);return t||ce("useModal instance is undefined!"),t};return[function(n,o){if(!oe())throw new Error("useModal() can only be used inside setup() or functional components!");l.value=o,x((()=>{e.value=null,t.value=!1,Ne[g(l)]=null})),g(t)&&se()&&n===g(e)||(e.value=n,t.value=!0,n.emitVisible=(e,t)=>{Re[t]=e})},{setModalProps:e=>{var t;null==(t=n())||t.setModalProps(e)},getVisible:B((()=>Re[~~g(l)])),redoModalHeight:()=>{var e,t;null==(t=null==(e=n())?void 0:e.redoModalHeight)||t.call(e)},openModal:(e=!0,t,o=!0)=>{var a;if(null==(a=n())||a.setModalProps({visible:e}),!t)return;const r=g(l);if(o)return Ne[r]=null,void(Ne[r]=ie(t));me(ie(Ne[r]),ie(t))||(Ne[r]=ie(t))},closeModal:()=>{var e;null==(e=n())||e.setModalProps({visible:!1})}}]}const Ae=e=>{const t=F(null),l=oe(),n=F(""),o=()=>{const e=g(t);return e||ce("useModalInner instance is undefined!"),e};return f((()=>{const t=Ne[g(n)];t&&e&&U(e)&&j((()=>{e(t)}))})),[(e,o)=>{ue((()=>{t.value=null})),n.value=o,t.value=e,null==l||l.emit("register",e,o)},{changeLoading:(e=!0)=>{var t;null==(t=o())||t.setModalProps({loading:e})},getVisible:B((()=>Re[~~g(n)])),changeOkLoading:(e=!0)=>{var t;null==(t=o())||t.setModalProps({confirmLoading:e})},closeModal:()=>{var e;null==(e=o())||e.setModalProps({visible:!1})},setModalProps:e=>{var t;null==(t=o())||t.setModalProps(e)},redoModalHeight:()=>{var e;const t=null==(e=o())?void 0:e.redoModalHeight;t&&t()}}]},Le=de($e);export{Le as B,Ce as C,Ae as a,Be as b,Ee as u};
