var e=Object.defineProperty,l=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,r=(l,t,a)=>t in l?e(l,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[t]=a,n=(e,l)=>{for(var t in l||(l={}))o.call(l,t)&&r(e,t,l[t]);if(a)for(var t of a(l))i.call(l,t)&&r(e,t,l[t]);return e},s=(e,l,t)=>new Promise(((a,o)=>{var i=e=>{try{n(t.next(e))}catch(l){o(l)}},r=e=>{try{n(t.throw(e))}catch(l){o(l)}},n=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,r);n((t=t.apply(e,l)).next())}));import{bo as d,a as c,w as u,k as p,f,o as b,j as m,H as y,E as h,G as v,i as I,n as g,ag as j}from"./index-c5a6c875.js";import{a as w,B as P}from"./index-c9e02f09.js";import{u as T,B as O}from"./useForm-76a4ff23.js";import{u as k,D as z}from"./index-2c15cc4f.js";const x=[{title:"应用ID",dataIndex:"clientId"},{title:"应用秘钥",dataIndex:"clientSecret"},{title:"授权类型",dataIndex:"authorizedGrantTypes"},{title:"授权范围",dataIndex:"scope"},{title:"令牌秒数",dataIndex:"accessTokenValidity"}],_=[{field:"clientId",label:"应用ID",component:"Input",colProps:{span:8}},{field:"clientSecret",label:"租户名称",component:"Input",colProps:{span:8}},{field:"linkman",label:"联系人",component:"Input",colProps:{span:8}}],G=[{field:"clientId",label:"应用ID",component:"Input",required:!0},{field:"clientSecret",label:"应用秘钥",component:"Input",required:!0},{field:"authorizedGrantTypes",label:"授权类型",component:"CheckboxGroup",componentProps:{options:[{label:"refresh_token",value:"refresh_token"},{label:"password",value:"password"},{label:"authorization_code",value:"authorization_code"},{label:"captcha",value:"captcha"},{label:"social",value:"social"}]},defaultValue:["refresh_token","password","authorization_code"],required:!0},{field:"scope",label:"授权范围",component:"Input",defaultValue:"all",required:!0},{field:"accessTokenValidity",label:"令牌秒数",component:"InputNumber",defaultValue:3600,required:!0},{field:"refreshTokenValidity",label:"刷新秒数",component:"InputNumber",defaultValue:604800,required:!0},{field:"webServerRedirectUri",label:"回调地址",component:"Input",required:!0},{field:"resourceIds",label:"资源集合",component:"Input"},{field:"authorities",label:"权限",component:"Input"},{field:"autoapprove",label:"自动授权",component:"Input"},{field:"additionalInformation",label:"附加说明",component:"Input"}],V=[{field:"clientId",label:"应用ID"},{field:"clientSecret",label:"应用秘钥"},{field:"authorizedGrantTypes",label:"授权类型"},{field:"scope",label:"授权范围"},{field:"accessTokenValidity",label:"令牌秒数"},{field:"refreshTokenValidity",label:"刷新秒数"},{field:"webServerRedirectUri",label:"回调地址"},{field:"resourceIds",label:"资源集合"},{field:"authorities",label:"权限"},{field:"autoapprove",label:"自动授权"},{field:"additionalInformation",label:"附加说明"}],S=e=>d.get({url:"/blade-system/client/list",params:e},{joinTime:!1}),D=e=>d.get({url:"/blade-system/client/detail",params:e}),R=e=>d.post({url:"/blade-system/client/remove",params:e},{joinParamsToUrl:!0}),q=c({emits:["success","register"],setup(e,{emit:a}){const o=u(!0),i=u(!0),r=u(""),[c,{setDescProps:x}]=k({schema:V}),[_,{setFieldsValue:S,resetFields:R,validate:q}]=T({labelWidth:100,schemas:G,showActionButtonGroup:!1,baseColProps:{span:12},actionColOptions:{span:23}}),[B,{setModalProps:U,closeModal:C}]=w((e=>s(this,null,(function*(){if(R(),i.value=!!(null==e?void 0:e.isUpdate),o.value=!!(null==e?void 0:e.isDetail),p(o)){const l=yield D({id:e.record.id});x({data:l})}else if(p(i)){r.value=e.record.id;const l=yield D({id:e.record.id});l.authorizedGrantTypes=l.authorizedGrantTypes.split(","),S(n({},l))}U({confirmLoading:!1})})))),F=f((()=>p(i)?"编辑应用":p(o)?"应用详情":"新增应用"));function L(){return s(this,null,(function*(){try{const c=yield q();U({confirmLoading:!0}),c.authorizedGrantTypes&&(c.authorizedGrantTypes=c.authorizedGrantTypes.join(",")),p(i)&&(c.id=r.value),yield(s=c,d.post({url:"/blade-system/client/submit",params:s})),C(),a("success",{isUpdate:p(i),values:(e=n({},c),o={id:r.value},l(e,t(o)))})}finally{U({confirmLoading:!1})}var e,o,s}))}return(e,l)=>(b(),m(p(P),j(e.$attrs,{onRegister:p(B),title:p(F),onOk:L,width:1200,showOkBtn:!o.value}),{default:y((()=>[h(I("div",null,[g(p(z),{size:"middle",onRegister:p(c),column:2},null,8,["onRegister"])],512),[[v,o.value]]),h(I("div",null,[g(p(O),{onRegister:p(_)},null,8,["onRegister"])],512),[[v,!o.value]])])),_:1},16,["onRegister","title","showOkBtn"]))}}),B=Object.freeze(Object.defineProperty({__proto__:null,default:q},Symbol.toStringTag,{value:"Module"}));export{B as C,q as _,x as c,S as g,R as r,_ as s};
