var y=(g,c,l)=>new Promise((d,e)=>{var r=a=>{try{f(l.next(a))}catch(p){e(p)}},t=a=>{try{f(l.throw(a))}catch(p){e(p)}},f=a=>a.done?d(a.value):Promise.resolve(a.value).then(r,t);f((l=l.apply(g,c)).next())});import{w as U,x as B,T as F,y as M,A as N,M as T,l as L}from"./element-plus-cbff5993.js";import{g as S,a as q}from"./index-92215f6d.js";import{g as K,d as P}from"./menu-b7fe4809.js";import{g as X,r as b,m as $,s as w,U as j,o as x,ab as R,ac as s,b as z,c as n,X as k,S as G,u as i,L as H}from"./@vue-f164b9f1.js";import{_ as J}from"./_plugin-vue_export-helper-c27b6911.js";import"./lodash-unified-cbbf5a2b.js";import"./lodash-d8f670e1.js";import"./@amap-9fd45ac7.js";import"./@sxzz-ad8bfd58.js";import"./@vueuse-b183cf27.js";import"./@element-plus-296a610a.js";import"./dayjs-f0fd0f9b.js";import"./async-validator-f102eabc.js";import"./@ctrl-43a29356.js";import"./escape-html-12e99df8.js";import"./normalize-wheel-es-c175a4cf.js";import"./vue-4c7ac246.js";import"./@floating-ui-5f39704e.js";import"./memoize-one-0650c7b0.js";import"./pinia-b6a13eed.js";import"./vue-demi-68b8001f.js";import"./axios-226f391c.js";import"./qs-b010a38c.js";import"./side-channel-a082fe58.js";import"./get-intrinsic-5660d814.js";import"./has-symbols-8f82dcae.js";import"./function-bind-22e7ee79.js";import"./has-26d28e02.js";import"./call-bind-75c15918.js";import"./object-inspect-4572ba77.js";import"./preload-helper-41c905a7.js";import"./vue-router-bc8ea068.js";import"./nprogress-57f984c9.js";import"./lodash-es-ca3eac7d.js";const O={name:[{type:"string",required:!0,message:"角色名称是必填项",trigger:"blur"}]};function Q(g,c){let l=[];return g.forEach(d=>{function e(r){r.forEach(t=>{d===t.id&&!t.children?l.push(t.id):t.children&&e(t.children)})}e(c)}),l}const W={class:"dialog-footer"},Y=X({__name:"AddRoleDialog",emits:["refresh"],setup(g,{expose:c,emit:l}){const d=b();let e=$({name:"",description:"",menuId:[]});const r=b(!1);let t=b(!1);const f=()=>{d.value.validate(v=>y(this,null,function*(){if(!!v){t.value=!0;try{e.id?yield S(e):yield q(H(e)),l("refresh"),r.value=!1,L.ElMessage({message:"操作成功",type:"success"})}finally{t.value=!1}}}))},a=w();let p=w([]);return c({openDialog:E=>y(this,[E],function*({name:v,description:o,menuId:_,id:u}){r.value=!0;const{data:h}=yield K();p.value=P(h),u?(e.id=u,e.name=v,e.description=o,e.menuId=_,a.value.setCheckedKeys(Q(_,p.value))):d.value.resetFields()})}),(v,o)=>{const _=U,u=B,E=F,h=M,V=N,A=T,D=j("auth");return x(),R(A,{modelValue:r.value,"onUpdate:modelValue":o[4]||(o[4]=m=>r.value=m),title:"新增角色",width:"30%"},{footer:s(()=>[z("span",W,[n(V,{onClick:o[3]||(o[3]=m=>r.value=!1)},{default:s(()=>[k("取消")]),_:1}),G((x(),R(V,{type:"primary",loading:i(t),onClick:f},{default:s(()=>[k(" 确定 ")]),_:1},8,["loading"])),[[D,["addRole"]]])])]),default:s(()=>[n(h,{ref_key:"formRef",ref:d,model:i(e),"status-icon":"",rules:i(O),"label-width":"80px"},{default:s(()=>[n(u,{label:"角色名称",prop:"name"},{default:s(()=>[n(_,{modelValue:i(e).name,"onUpdate:modelValue":o[0]||(o[0]=m=>i(e).name=m),clearable:"",autofocus:"",placeholder:"请输入角色名称"},null,8,["modelValue"])]),_:1}),n(u,{label:"角色描述",prop:"description"},{default:s(()=>[n(_,{modelValue:i(e).description,"onUpdate:modelValue":o[1]||(o[1]=m=>i(e).description=m),max:255,rows:1,type:"textarea",placeholder:"请输入角色描述"},null,8,["modelValue"])]),_:1}),n(u,{label:"菜单权限",prop:"menuId"},{default:s(()=>[n(E,{ref_key:"treeRef",ref:a,onCheck:o[2]||(o[2]=(m,{checkedKeys:C,halfCheckedKeys:I})=>i(e).menuId=[...C,...I]),"node-key":"id",data:i(p),multiple:"","show-checkbox":"",clearable:"",props:{label:"title",children:"children",value:"id"},style:{width:"100%"}},null,8,["data"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}});const Ne=J(Y,[["__scopeId","data-v-cf9ac7ad"]]);export{Ne as default};
