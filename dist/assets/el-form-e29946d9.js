var ke=Object.defineProperty,Te=Object.defineProperties;var De=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var ue=(l,o,e)=>o in l?ke(l,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[o]=e,x=(l,o)=>{for(var e in o||(o={}))de.call(o,e)&&ue(l,e,o[e]);if(z)for(var e of z(o))ce.call(o,e)&&ue(l,e,o[e]);return l},q=(l,o)=>Te(l,De(o));var fe=(l,o)=>{var e={};for(var s in l)de.call(l,s)&&o.indexOf(s)<0&&(e[s]=l[s]);if(l!=null&&z)for(var s of z(l))o.indexOf(s)<0&&ce.call(l,s)&&(e[s]=l[s]);return e};var B=(l,o,e)=>new Promise((s,t)=>{var d=b=>{try{c(e.next(b))}catch(h){t(h)}},n=b=>{try{c(e.throw(b))}catch(h){t(h)}},c=b=>b.done?s(b.value):Promise.resolve(b.value).then(d,n);c((e=e.apply(l,o)).next())});import{b as ye,d as Q,r as $,g as H,w as Ue,c as Ge}from"./base-27e822c2.js";import{c as _e,a as Se,d as le,f as ee}from"./index-56996fd0.js";import{s as Ke,f as te,Y as P,U as v,d as R,w as T,X as Fe,V as We,a9 as we,o as re,Z as Ee,r as k,aq as O,u as f,i as Ie,W as D,l as xe,aW as Ce,D as Xe,e as U,F as Ye,n as Le,bh as Ze,b as J,c as He,b7 as Je,as as me,aG as Qe,at as ve,aD as pe,_ as he}from"./runtime-core.esm-bundler-76eda81d.js";import{c as G}from"./index-e961436e.js";import{u as oe,_ as Me}from"./plugin-vue_export-helper-529fb311.js";import{d as et,t as tt}from"./error-78e43d3e.js";import{T as rt}from"./runtime-dom.esm-bundler-eeabfc76.js";import{S as lt}from"./index-806b99e8.js";import{u as ot}from"./index-35e23b9e.js";import{a as ge}from"./style-e1000a00.js";const st=ye({model:Object,rules:{type:Q(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},size:{type:String,values:_e},disabled:Boolean,validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:{type:Boolean,default:!1},scrollToError:Boolean}),at={validate:(l,o,e)=>(Ke(l)||te(l))&&G.isBoolean(o)&&te(e)};function it(){const l=P([]),o=v(()=>{if(!l.value.length)return"0";const d=Math.max(...l.value);return d?`${d}px`:""});function e(d){const n=l.value.indexOf(d);return n===-1&&o.value,n}function s(d,n){if(d&&n){const c=e(n);l.value.splice(c,1,d)}else d&&l.value.push(d)}function t(d){const n=e(d);n>-1&&l.value.splice(n,1)}return{autoLabelWidth:o,registerLabelWidth:s,deregisterLabelWidth:t}}const j=(l,o)=>{const e=$.castArray(o);return e.length>0?l.filter(s=>s.prop&&e.includes(s.prop)):l},nt="ElForm",ut=R({name:nt}),dt=R(q(x({},ut),{props:st,emits:at,setup(l,{expose:o,emit:e}){const s=l,t=[],d=Se(),n=oe("form"),c=v(()=>{const{labelPosition:i,inline:m}=s;return[n.b(),n.m(d.value||"default"),{[n.m(`label-${i}`)]:i,[n.m("inline")]:m}]}),b=i=>{t.push(i)},h=i=>{i.prop&&t.splice(t.indexOf(i),1)},u=(i=[])=>{!s.model||j(t,i).forEach(m=>m.resetField())},y=(i=[])=>{j(t,i).forEach(m=>m.clearValidate())},S=v(()=>!!s.model),C=i=>{if(t.length===0)return[];const m=j(t,i);return m.length?m:[]},M=i=>B(this,null,function*(){return w(void 0,i)}),W=(...m)=>B(this,[...m],function*(i=[]){if(!S.value)return!1;const A=C(i);if(A.length===0)return!0;let L={};for(const _ of A)try{yield _.validate("")}catch(E){L=x(x({},L),E)}return Object.keys(L).length===0?!0:Promise.reject(L)}),w=(...A)=>B(this,[...A],function*(i=[],m){const L=!Ie(m);try{const _=yield W(i);return _===!0&&(m==null||m(_)),_}catch(_){if(_ instanceof Error)throw _;const E=_;return s.scrollToError&&V(Object.keys(E)[0]),m==null||m(!1,E),L&&Promise.reject(E)}}),V=i=>{var m;const A=j(t,i)[0];A&&((m=A.$el)==null||m.scrollIntoView())};return T(()=>s.rules,()=>{s.validateOnRuleChange&&M().catch(i=>et())},{deep:!0}),Fe(le,We(x(q(x({},we(s)),{emit:e,resetFields:u,clearValidate:y,validateField:w,addField:b,removeField:h}),it()))),o({validate:M,validateField:w,resetFields:u,clearValidate:y,scrollToField:V}),(i,m)=>(re(),Ee("form",{class:O(f(c))},[k(i.$slots,"default")],2))}}));var ct=Me(dt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/form/src/form.vue"]]);const ft=["","error","validating","success"],mt=ye({label:String,labelWidth:{type:[String,Number],default:""},prop:{type:Q([String,Array])},required:{type:Boolean,default:void 0},rules:{type:Q([Object,Array])},error:String,validateStatus:{type:String,values:ft},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:_e}}),be="ElLabelWrap";var vt=R({name:be,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(l,{slots:o}){const e=D(le,void 0),s=D(ee);s||tt(be,"usage: <el-form-item><label-wrap /></el-form-item>");const t=oe("form"),d=P(),n=P(0),c=()=>{var u;if((u=d.value)!=null&&u.firstElementChild){const y=window.getComputedStyle(d.value.firstElementChild).width;return Math.ceil(Number.parseFloat(y))}else return 0},b=(u="update")=>{Le(()=>{o.default&&l.isAutoWidth&&(u==="update"?n.value=c():u==="remove"&&(e==null||e.deregisterLabelWidth(n.value)))})},h=()=>b("update");return xe(()=>{h()}),Ce(()=>{b("remove")}),Xe(()=>h()),T(n,(u,y)=>{l.updateAll&&(e==null||e.registerLabelWidth(u,y))}),G.useResizeObserver(v(()=>{var u,y;return(y=(u=d.value)==null?void 0:u.firstElementChild)!=null?y:null}),h),()=>{var u,y;if(!o)return null;const{isAutoWidth:S}=l;if(S){const C=e==null?void 0:e.autoLabelWidth,M=s==null?void 0:s.hasLabel,W={};if(M&&C&&C!=="auto"){const w=Math.max(0,Number.parseInt(C,10)-n.value),V=e.labelPosition==="left"?"marginRight":"marginLeft";w&&(W[V]=`${w}px`)}return U("div",{ref:d,class:[t.be("item","label-wrap")],style:W},[(u=o.default)==null?void 0:u.call(o)])}else return U(Ye,{ref:d},[(y=o.default)==null?void 0:y.call(o)])}}});const pt=["role","aria-labelledby"],ht=R({name:"ElFormItem"}),gt=R(q(x({},ht),{props:mt,setup(l,{expose:o}){const e=l,s=Ze(),t=D(le,void 0),d=D(ee,void 0),n=Se(void 0,{formItem:!1}),c=oe("form-item"),b=ot().value,h=P([]),u=P(""),y=G.refDebounced(u,100),S=P(""),C=P();let M,W=!1;const w=v(()=>{if((t==null?void 0:t.labelPosition)==="top")return{};const r=ge(e.labelWidth||(t==null?void 0:t.labelWidth)||"");return r?{width:r}:{}}),V=v(()=>{if((t==null?void 0:t.labelPosition)==="top"||(t==null?void 0:t.inline))return{};if(!e.label&&!e.labelWidth&&Be)return{};const r=ge(e.labelWidth||(t==null?void 0:t.labelWidth)||"");return!e.label&&!s.label?{marginLeft:r}:{}}),i=v(()=>[c.b(),c.m(n.value),c.is("error",u.value==="error"),c.is("validating",u.value==="validating"),c.is("success",u.value==="success"),c.is("required",Ne.value||e.required),c.is("no-asterisk",t==null?void 0:t.hideRequiredAsterisk),(t==null?void 0:t.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[c.m("feedback")]:t==null?void 0:t.statusIcon}]),m=v(()=>G.isBoolean(e.inlineMessage)?e.inlineMessage:(t==null?void 0:t.inlineMessage)||!1),A=v(()=>[c.e("error"),{[c.em("error","inline")]:m.value}]),L=v(()=>e.prop?te(e.prop)?e.prop:e.prop.join("."):""),_=v(()=>!!(e.label||s.label)),E=v(()=>e.for||h.value.length===1?h.value[0]:void 0),K=v(()=>!E.value&&_.value),Be=!!d,se=v(()=>{const r=t==null?void 0:t.model;if(!(!r||!e.prop))return H(r,e.prop).value}),X=v(()=>{const{required:r}=e,a=[];e.rules&&a.push(...$.castArray(e.rules));const g=t==null?void 0:t.rules;if(g&&e.prop){const p=H(g,e.prop).value;p&&a.push(...$.castArray(p))}if(r!==void 0){const p=a.map((F,I)=>[F,I]).filter(([F])=>Object.keys(F).includes("required"));if(p.length>0)for(const[F,I]of p)F.required!==r&&(a[I]=q(x({},F),{required:r}));else a.push({required:r})}return a}),Pe=v(()=>X.value.length>0),Ve=r=>X.value.filter(g=>!g.trigger||!r?!0:Array.isArray(g.trigger)?g.trigger.includes(r):g.trigger===r).map(F=>{var I=F,{trigger:g}=I,p=fe(I,["trigger"]);return p}),Ne=v(()=>X.value.some(r=>r.required)),qe=v(()=>{var r;return y.value==="error"&&e.showMessage&&((r=t==null?void 0:t.showMessage)!=null?r:!0)}),ae=v(()=>`${e.label||""}${(t==null?void 0:t.labelSuffix)||""}`),N=r=>{u.value=r},$e=r=>{var a,g;const{errors:p,fields:F}=r;(!p||!F)&&console.error(r),N("error"),S.value=p?(g=(a=p==null?void 0:p[0])==null?void 0:a.message)!=null?g:`${e.prop} is required`:"",t==null||t.emit("validate",e.prop,!1,S.value)},Oe=()=>{N("success"),t==null||t.emit("validate",e.prop,!0,"")},Re=r=>B(this,null,function*(){const a=L.value;return new lt({[a]:r}).validate({[a]:se.value},{firstFields:!0}).then(()=>(Oe(),!0)).catch(p=>($e(p),Promise.reject(p)))}),ie=(r,a)=>B(this,null,function*(){if(W||!e.prop)return!1;const g=Ie(a);if(!Pe.value)return a==null||a(!1),!1;const p=Ve(r);return p.length===0?(a==null||a(!0),!0):(N("validating"),Re(p).then(()=>(a==null||a(!0),!0)).catch(F=>{const{fields:I}=F;return a==null||a(!1,I),g?!1:Promise.reject(I)}))}),Y=()=>{N(""),S.value="",W=!1},ne=()=>B(this,null,function*(){const r=t==null?void 0:t.model;if(!r||!e.prop)return;const a=H(r,e.prop);W=!0,a.value=$.clone(M),yield Le(),Y(),W=!1}),ze=r=>{h.value.includes(r)||h.value.push(r)},je=r=>{h.value=h.value.filter(a=>a!==r)};T(()=>e.error,r=>{S.value=r||"",N(r?"error":"")},{immediate:!0}),T(()=>e.validateStatus,r=>N(r||""));const Z=We(q(x({},we(e)),{$el:C,size:n,validateState:u,labelId:b,inputIds:h,isGroup:K,hasLabel:_,addInputId:ze,removeInputId:je,resetField:ne,clearValidate:Y,validate:ie}));return Fe(ee,Z),xe(()=>{e.prop&&(t==null||t.addField(Z),M=$.clone(se.value))}),Ce(()=>{t==null||t.removeField(Z)}),o({size:n,validateMessage:S,validateState:u,validate:ie,clearValidate:Y,resetField:ne}),(r,a)=>{var g;return re(),Ee("div",{ref_key:"formItemRef",ref:C,class:O(f(i)),role:f(K)?"group":void 0,"aria-labelledby":f(K)?f(b):void 0},[U(f(vt),{"is-auto-width":f(w).width==="auto","update-all":((g=f(t))==null?void 0:g.labelWidth)==="auto"},{default:J(()=>[f(_)?(re(),He(Je(f(E)?"label":"div"),{key:0,id:f(b),for:f(E),class:O(f(c).e("label")),style:me(f(w))},{default:J(()=>[k(r.$slots,"label",{label:f(ae)},()=>[Qe(ve(f(ae)),1)])]),_:3},8,["id","for","class","style"])):pe("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),he("div",{class:O(f(c).e("content")),style:me(f(V))},[k(r.$slots,"default"),U(rt,{name:`${f(c).namespace.value}-zoom-in-top`},{default:J(()=>[f(qe)?k(r.$slots,"error",{key:0,error:S.value},()=>[he("div",{class:O(f(A))},ve(S.value),3)]):pe("v-if",!0)]),_:3},8,["name"])],6)],10,pt)}}}));var Ae=Me(gt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/form/src/form-item.vue"]]);const Lt=Ue(ct,{FormItem:Ae}),Mt=Ge(Ae);export{Lt as E,Mt as a};
