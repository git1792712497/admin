var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,o=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,n=(e,l)=>{for(var a in l||(l={}))r.call(l,a)&&o(e,a,l[a]);if(t)for(var a of t(l))u.call(l,a)&&o(e,a,l[a]);return e},i=(e,t)=>l(e,a(t)),s=(e,l,a)=>new Promise(((t,r)=>{var u=e=>{try{n(a.next(e))}catch(l){r(l)}},o=e=>{try{n(a.throw(e))}catch(l){r(l)}},n=e=>e.done?t(e.value):Promise.resolve(e.value).then(u,o);n((a=a.apply(e,l)).next())}));import{bo as d,a as c,cc as p,ct as f,eg as v,w as m,ab as _,o as g,j as h,H as b,n as y,k as w,h as A,am as O,K as U,t as j,O as x,as as I,eh as k}from"./index-c5a6c875.js";import D from"./FileUpload-27b75cd8.js";import{a as E,B as P}from"./index-6c947566.js";import{u as S}from"./attach-17a7a276.js";import{E as T,a as z}from"./EyeOutlined-274e25e9.js";const L={websiteId:[{required:!0,message:"站点名称是必选项",trigger:"blur",whitespace:!0}],columnId:[{required:!0,message:"所属栏目是必选项",trigger:"blur",whitespace:!0}],title:[{required:!0,message:"文章标题是必填项",trigger:"blur"}]};function q(e){return d.post({url:"/article/save",params:e})}function C(e){return d.post({url:"/article/query",params:i(n({pagination:{size:e.size,current:e.current}},e),{size:void 0,current:void 0})})}function R(e){return d.get({url:"/column/tree",params:e})}function M(e){return d.delete({url:`/article/delete/${e}`})}const Y=Object.freeze(Object.defineProperty({__proto__:null,getAddOrEditArticleApi:q,getArticleListApi:C,getColumnTreeApi:R,getWebsiteListApi:function(e){return d.post({url:"/website/query",params:i(n({pagination:{size:e.size,current:e.current}},e),{size:void 0,current:void 0})})},getArticleDeleteApi:M},Symbol.toStringTag,{value:"Module"})),F=U("上传"),W=c({emits:["success"],setup(e,{expose:l,emit:a}){const t=p((()=>f((()=>import("./WangEditor-ec800a71.js")),["./WangEditor-ec800a71.js","./index-c5a6c875.js","./index-6aa08860.css","./attach-17a7a276.js","./WangEditor-40bc70e4.css"],import.meta.url))),[r,{openDrawer:u}]=E();let o=v(!1),d=m({coverImages:[],top:!1,content:""}),c=m({time:[],activityAddress:void 0,file:[]});const C=v(),M=()=>s(this,null,(function*(){yield C.value.validate(),o.value=!0;const e=I(w(d.value)),l=I(w(c)),t=i(n({},e),{extendData:{activityStartTime:l.time[0],activityEndTime:l.time[1],activityAddress:l.activityAddress,file:l.file}});try{yield q(t),k.success("文章新增成功"),a("success"),u(!1)}finally{o.value=!1}}));let W=v([]),H=v();let N=v(!1);const V=e=>s(this,[e],(function*({file:e}){N.value=!0,S({file:e}).then((e=>{var l;k.success("上传成功"),null==(l=d.value.coverImages)||l.push(e.data.data.link)})).finally((()=>{N.value=!1}))}));return l({openAddOrEditArticleDrawer:e=>s(this,null,(function*(){var l,a,t,r;d.value=e,c.value.time=[null==(l=e.extendData)?void 0:l.activityStartTime,null==(a=e.extendData)?void 0:a.activityEndTime],c.value.activityAddress=null==(t=e.extendData)?void 0:t.activityAddress,c.value.file=null==(r=e.extendData)?void 0:r.file,R().then((e=>H.value=e.nodes));const{getWebsiteListApi:o}=yield f((()=>Promise.resolve().then((()=>Y))),void 0,import.meta.url),n=yield o({});W.value=n.records,u()}))}),(e,l)=>{const a=_("a-select-option"),u=_("a-select"),n=_("a-form-item"),i=_("a-col"),s=_("a-tree-select"),p=_("a-row"),f=_("a-input"),v=_("a-textarea"),m=_("a-button"),I=_("a-upload"),k=_("a-badge"),E=_("a-switch"),S=_("a-range-picker"),q=_("a-form"),R=_("a-card");return g(),h(w(P),{confirmLoading:w(o),width:"60%",bodyStyle:{background:"#f0f2f5"},title:w(d).id?"编辑文章":"新增文章",showFooter:"",onOk:M,closable:!1,onRegister:w(r)},{default:b((()=>[y(R,null,{default:b((()=>[y(q,{layout:"vertical",ref_key:"formRef",ref:C,model:w(d),rules:w(L)},{default:b((()=>[y(p,null,{default:b((()=>[y(i,{span:11},{default:b((()=>[y(n,{label:"站点名称",name:"websiteId"},{default:b((()=>[y(u,{value:w(d).websiteId,"onUpdate:value":l[0]||(l[0]=e=>w(d).websiteId=e),placeholder:"请选择站点"},{default:b((()=>[(g(!0),A(x,null,O(w(W),(e=>(g(),h(a,{value:e.id},{default:b((()=>[U(j(e.name),1)])),_:2},1032,["value"])))),256))])),_:1},8,["value"])])),_:1})])),_:1}),y(i,{span:12,offset:1},{default:b((()=>[y(n,{label:"所属栏目",name:"columnId"},{default:b((()=>[y(s,{onChange:l[1]||(l[1]=(e,l)=>w(d).columnName=l.pop()),value:w(d).columnId,"onUpdate:value":l[2]||(l[2]=e=>w(d).columnId=e),fieldNames:{children:"children",label:"name",value:"id"},"show-search":"","dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择所属栏目名称","allow-clear":"","tree-data":w(H)},null,8,["value","tree-data"])])),_:1})])),_:1})])),_:1}),y(p,null,{default:b((()=>[y(i,{span:11},{default:b((()=>[y(n,{label:"文章标题",name:"title"},{default:b((()=>[y(f,{value:w(d).title,"onUpdate:value":l[3]||(l[3]=e=>w(d).title=e),placeholder:"请输入文章标题","allow-clear":""},null,8,["value"])])),_:1})])),_:1}),y(i,{span:12,offset:1},{default:b((()=>[y(n,{label:"跳转链接",name:"linkUrl"},{default:b((()=>[y(f,{value:w(d).linkUrl,"onUpdate:value":l[4]||(l[4]=e=>w(d).linkUrl=e),placeholder:"请输入跳转链接","allow-clear":""},null,8,["value"])])),_:1})])),_:1})])),_:1}),y(p,null,{default:b((()=>[y(i,{span:11},{default:b((()=>[y(n,{label:"文章来源",name:"source"},{default:b((()=>[y(f,{value:w(d).source,"onUpdate:value":l[5]||(l[5]=e=>w(d).source=e),placeholder:"请输入文章来源","allow-clear":""},null,8,["value"])])),_:1})])),_:1}),y(i,{span:12,offset:1},{default:b((()=>[y(n,{label:"重点标识",name:"highlight"},{default:b((()=>[y(f,{value:w(d).highlight,"onUpdate:value":l[6]||(l[6]=e=>w(d).highlight=e),placeholder:"请输入重点标识","allow-clear":""},null,8,["value"])])),_:1})])),_:1})])),_:1}),y(p,null,{default:b((()=>[y(i,{span:11},{default:b((()=>[y(n,{label:"文章副标题",name:"subtitle"},{default:b((()=>[y(v,{value:w(d).subtitle,"onUpdate:value":l[7]||(l[7]=e=>w(d).subtitle=e),maxlength:125,rows:1,allowClear:"",placeholder:"请输入文章副标题",showCount:""},null,8,["value"])])),_:1})])),_:1}),y(i,{sapn:6,offset:1},{default:b((()=>[y(n,{label:"文章封面图",name:"coverImages"},{default:b((()=>{var e;return[y(I,{accept:"image/*",customRequest:V,multiple:"",showUploadList:!1},{default:b((()=>[y(m,{loading:w(N),ghost:"",type:"primary"},{default:b((()=>[F])),_:1},8,["loading"])])),_:1}),y(k,{count:null==(e=w(d).coverImages)?void 0:e.length},{default:b((()=>[y(m,{ghost:"",style:{"margin-left":"10px"},type:"primary"},{default:b((()=>{var e;return[(null==(e=w(d).coverImages)?void 0:e.length)?(g(),h(w(T),{key:0})):(g(),h(w(z),{key:1}))]})),_:1})])),_:1},8,["count"])]})),_:1})])),_:1}),y(i,{span:3,offset:5},{default:b((()=>[y(n,{label:"是否置顶",name:"top"},{default:b((()=>[y(E,{checked:w(d).top,"onUpdate:checked":l[8]||(l[8]=e=>w(d).top=e)},null,8,["checked"])])),_:1})])),_:1})])),_:1}),y(n,{label:"文章简介",name:"introduction"},{default:b((()=>[y(v,{value:w(d).introduction,"onUpdate:value":l[9]||(l[9]=e=>w(d).introduction=e),maxlength:255,rows:3,allowClear:"",placeholder:"请输入文章内容简介",showCount:""},null,8,["value"])])),_:1}),y(p,null,{default:b((()=>[y(i,{span:7},{default:b((()=>[y(n,{label:"活动时间"},{default:b((()=>[y(S,{value:w(c).time,"onUpdate:value":l[10]||(l[10]=e=>w(c).time=e),valueFormat:"YYYY-MM-DD"},null,8,["value"])])),_:1})])),_:1}),y(i,{span:10,offset:1},{default:b((()=>[y(n,{label:"活动地址"},{default:b((()=>[y(f,{value:w(c).activityAddress,"onUpdate:value":l[11]||(l[11]=e=>w(c).activityAddress=e),placeholder:"请输入活动地址","allow-clear":""},null,8,["value"])])),_:1})])),_:1}),y(i,{span:5,offset:1},{default:b((()=>[y(n,{label:"研报附件"},{default:b((()=>{var e;return[y(D,{count:null==(e=w(c).file)?void 0:e.length,onUploadSuccess:l[12]||(l[12]=e=>w(c).file.push(e))},null,8,["count"])]})),_:1})])),_:1})])),_:1}),y(n,{label:"文章内容"},{default:b((()=>[y(w(t),{value:w(d).content,"onUpdate:value":l[13]||(l[13]=e=>w(d).content=e)},null,8,["value"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1},8,["confirmLoading","title","onRegister"])}}}),H=Object.freeze(Object.defineProperty({__proto__:null,default:W},Symbol.toStringTag,{value:"Module"}));export{H as A,W as _,M as a,C as g};
