var e=Object.defineProperty,o=Object.defineProperties,t=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,s=(o,t,n)=>t in o?e(o,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[t]=n,l=(e,o,t)=>new Promise(((n,a)=>{var r=e=>{try{l(t.next(e))}catch(o){a(o)}},s=e=>{try{l(t.throw(e))}catch(o){a(o)}},l=e=>e.done?n(e.value):Promise.resolve(e.value).then(r,s);l((t=t.apply(e,o)).next())}));import{a as i,d,r as c}from"./region-dd8311c2.js";import{a as p}from"./index-33df9098.js";import u from"./RegionTree-b836a431.js";import m from"./RegionSelectModal-7a5a7eab.js";import{a as f,w as b,b2 as g,ab as v,ac as y,o as j,j as h,H as w,n as P,i as C,k as x,dE as O,E as _,I,h as k,am as S,K as q,t as F,O as R,bn as E,S as H,cP as T,y as B,v as L}from"./index-c5a6c875.js";import{u as M}from"./index-c9e02f09.js";import{d as U}from"./download-0641dcf7.js";import{u as V,B as $}from"./useForm-76a4ff23.js";import{g as A}from"./system-54dc9bf1.js";import"./onMountedOrActivated-48cd1b25.js";import"./useWindowSizeFn-72c85a53.js";import"./useContentViewHeight-e138bd2a.js";import"./FullscreenOutlined-9b414b92.js";import"./isEqual-f9888ec4.js";import"./_baseIsEqual-f0bca653.js";import"./index-bb91fa2a.js";import"./get-8f9589fb.js";import"./uuid-f62a8acd.js";import"./index-b52e0339.js";import"./uniqBy-e29b0e8a.js";const K=[{field:"id",label:"id",component:"Input",show:!1,componentProps:{disabled:!0},colProps:{span:24}},{field:"parentCode",label:"父区划编号",component:"Input",required:!0,componentProps:{disabled:!0},colProps:{span:24}},{field:"parentName",label:"父区划名称",component:"Input",componentProps:{disabled:!0}},{field:"code",label:"区划编号",component:"Input",show:!1,slot:"codeSlot",colProps:{span:24}},{field:"subCode",label:"区划编号",component:"Input",slot:"codeSlot",required:!0,colProps:{span:24}},{field:"name",label:"区划名称",component:"Input",required:!0,colProps:{span:24}},{field:"regionLevel",label:"区划等级",component:"Input",required:!0,slot:"levelSlot",colProps:{span:24}},{field:"sort",label:"区划排序",component:"InputNumber",required:!0,colProps:{span:24}},{field:"remark",label:"区划备注",component:"InputTextArea",colProps:{span:24}}],N={class:"m-4 mr-0 bg-white"},z=q("新增下级"),G=q("删除"),W=q("导出"),D=q("调试"),J=f({setup(e){const f=b(),{createMessage:J,createConfirm:Q}=H(),X=g.Group,[Y,{openModal:Z}]=M(),[ee,{setFieldsValue:oe,validate:te,getFieldsValue:ne}]=V({labelWidth:100,schemas:K,showActionButtonGroup:!0,submitFunc:function(){return l(this,null,(function*(){const e=yield te(),o="00"===e.parentCode?"":e.parentCode;e.code=o+e.subCode,yield i(e),J.success("添加成功")}))},submitButtonOptions:{text:"提交"},baseColProps:{span:24},actionColOptions:{span:23}});function ae(e="00"){return l(this,null,(function*(){const l=yield d({code:e});var i,c;oe((i=((e,o)=>{for(var t in o||(o={}))a.call(o,t)&&s(e,t,o[t]);if(n)for(var t of n(o))r.call(o,t)&&s(e,t,o[t]);return e})({},l),c={subCode:l.code.replace(l.parentCode,"")},o(i,t(c))))}))}function re(){const e=ne();e.code&&e.name?oe({parentCode:e.code,parentName:e.name,code:"",subCode:"",name:"",regionLevel:5===e.regionLevel?5:e.regionLevel+1}):J.error("请先选择一项区划")}function se(){Z(!0)}function le(){Q({iconType:"warning",title:()=>T("span","确认"),content:()=>T("span","是否导出行政区划数据?"),onOk:()=>{U({url:`/api/blade-system/region/export-region?${B.tokenHeader}=${L().getToken}`})}})}function ie(){return l(this,null,(function*(){const e=ne();e.code?Q({iconType:"warning",title:()=>T("span","确认"),content:()=>T("span",`确定将 [${e.name}] 数据删除?`),onOk:()=>l(this,null,(function*(){yield c({id:e.id}),J.success("操作成功")}))}):J.error("请先选择一项区划")}))}return function(){l(this,null,(function*(){const e=yield A({code:"region"});f.value=e}))}(),(e,o)=>{const t=v("a-button"),n=y("auth");return j(),h(x(p),{dense:"",contentFullHeight:"",fixedHeight:"",contentClass:"flex"},{default:w((()=>[P(u,{class:"w-2/4 xl:w-2/5",onSelect:ae}),C("div",N,[P(x(E),{direction:"vertical",size:"small"},{default:w((()=>[P(x(O),null,{default:w((()=>[_((j(),h(t,{type:"primary",onClick:re},{default:w((()=>[z])),_:1})),[[n,"region_add"]]),_((j(),h(t,{type:"primary",onClick:ie,danger:""},{default:w((()=>[G])),_:1})),[[n,"region_delete"]]),_((j(),h(t,{onClick:le},{default:w((()=>[W])),_:1})),[[n,"region_export"]]),_((j(),h(t,{type:"primary",onClick:se},{default:w((()=>[D])),_:1})),[[n,"region_debug"]])])),_:1}),P(x($),{onRegister:x(ee),class:"w-2/4 xl:w-3/5"},{codeSlot:w((({model:e,field:o})=>[P(x(I),{"addon-before":e.parentCode,value:e[o],"onUpdate:value":t=>e[o]=t},null,8,["addon-before","value","onUpdate:value"])])),levelSlot:w((({model:e,field:o})=>[P(x(X),{value:e[o],"onUpdate:value":t=>e[o]=t},{default:w((()=>[(j(!0),k(R,null,S(f.value,(e=>(j(),h(x(g),{key:`${e.dictKey}`,value:e.dictKey},{default:w((()=>[q(F(e.dictValue),1)])),_:2},1032,["value"])))),128))])),_:2},1032,["value","onUpdate:value"])])),_:1},8,["onRegister"])])),_:1})]),P(m,{onRegister:x(Y)},null,8,["onRegister"])])),_:1})}}});export{J as default};
