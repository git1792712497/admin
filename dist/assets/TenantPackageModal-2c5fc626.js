var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,i=(t,o,a)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[o]=a,n=(e,t)=>{for(var o in t||(t={}))r.call(t,o)&&i(e,o,t[o]);if(a)for(var o of a(t))s.call(t,o)&&i(e,o,t[o]);return e},l=(e,t,o)=>new Promise(((a,r)=>{var s=e=>{try{n(o.next(e))}catch(t){r(t)}},i=e=>{try{n(o.throw(e))}catch(t){r(t)}},n=e=>e.done?a(e.value):Promise.resolve(e.value).then(s,i);n((o=o.apply(e,t)).next())}));import{a as d,B as c}from"./index-c9e02f09.js";import{u as p,B as u}from"./useForm-76a4ff23.js";import{d as m,s as f}from"./tenantpackage-ad168568.js";import{d as b}from"./menu-b0618eaf.js";import{a as j,w as y,b6 as g,k as v,f as h,o as O,j as w,H as P,n as I,ag as x}from"./index-c5a6c875.js";import"./useWindowSizeFn-72c85a53.js";import"./FullscreenOutlined-9b414b92.js";import"./isEqual-f9888ec4.js";import"./_baseIsEqual-f0bca653.js";import"./index-bb91fa2a.js";import"./get-8f9589fb.js";import"./uuid-f62a8acd.js";import"./download-0641dcf7.js";import"./index-b52e0339.js";import"./uniqBy-e29b0e8a.js";const k=j({emits:["success","register"],setup(e,{emit:a}){const r=y(!0),s=y(""),[i,{setFieldsValue:j,resetFields:k,validate:q}]=p({labelWidth:100,schemas:[{field:"packageName",label:"产品包名",component:"Input",required:!0},{field:"menuId",label:"菜单列表",component:"ApiTreeSelect",componentProps:{api:b,treeCheckable:!0,showCheckedStrategy:g.SHOW_ALL,getPopupContainer:()=>document.body},required:!0},{field:"remark",label:"备注",component:"InputTextArea"}],showActionButtonGroup:!1,actionColOptions:{span:23},baseColProps:{span:24}}),[C,{setModalProps:F,closeModal:L}]=d((e=>l(this,null,(function*(){if(k(),r.value=!!(null==e?void 0:e.isUpdate),v(r)){s.value=e.record.id;const t=yield m({id:e.record.id});t.menuId=t.menuId.split(","),j(n({},t))}F({confirmLoading:!1})})))),S=h((()=>v(r)?"编辑":"新增"));function A(){return l(this,null,(function*(){try{const l=yield q();F({confirmLoading:!0}),v(r)&&(l.id=s.value),l.menuId=l.menuId.join(","),yield f(l),L(),a("success",{isUpdate:v(r),values:(e=n({},l),i={id:s.value},t(e,o(i)))})}finally{F({confirmLoading:!1})}var e,i}))}return(e,t)=>(O(),w(v(c),x(e.$attrs,{onRegister:v(C),title:v(S),onOk:A}),{default:P((()=>[I(v(u),{onRegister:v(i)},null,8,["onRegister"])])),_:1},16,["onRegister","title"]))}});export{k as default};
