var e=(e,t,n)=>new Promise(((o,s)=>{var i=e=>{try{r(n.next(e))}catch(t){s(t)}},a=e=>{try{r(n.throw(e))}catch(t){s(t)}},r=e=>e.done?o(e.value):Promise.resolve(e.value).then(i,a);r((n=n.apply(e,t)).next())}));import{B as t}from"./TableImg-d2c728a3.js";import{T as n}from"./useForm-76a4ff23.js";import{u as o}from"./useTable-0a379cac.js";import{d as s,r as i,e as a,f as r}from"./user-a4458d91.js";import{a as l}from"./index-33df9098.js";import c from"./DeptTree-64918dba.js";import{a as d,ab as u,ac as p,o as m,j as f,H as b,n as g,E as j,k as y,v as h,l as k,K as w,cP as x,y as _,S as R}from"./index-c5a6c875.js";import{u as C}from"./index-c9e02f09.js";import{c as I,s as S,_ as v}from"./AccountModal-57b0f4e0.js";import T from"./RoleSettingModal-6e356bc0.js";import M from"./ImportUserModal-72f0d90d.js";import{d as U}from"./download-0641dcf7.js";import"./CheckOutlined-752df576.js";import"./isEqual-f9888ec4.js";import"./_baseIsEqual-f0bca653.js";import"./uuid-f62a8acd.js";import"./merge-5148c4a3.js";import"./get-8f9589fb.js";import"./useWindowSizeFn-72c85a53.js";import"./onMountedOrActivated-48cd1b25.js";import"./sortable.esm-7c85b602.js";import"./RedoOutlined-e07a9f51.js";import"./FullscreenOutlined-9b414b92.js";import"./index-bb91fa2a.js";import"./index-b52e0339.js";import"./uniqBy-e29b0e8a.js";import"./useContentViewHeight-e138bd2a.js";import"./index-941b9c74.js";import"./dept-667428a4.js";import"./index-2c15cc4f.js";import"./system-54dc9bf1.js";import"./post-859b11b4.js";const F=w("新增"),O=w("角色配置"),K=w("密码重置"),D=w("账号解封"),H=w("导入"),N=w("导出"),P=d({setup(d){const{createMessage:w,createConfirm:P}=R(),{success:$,error:q}=w,[E,{openModal:A}]=C(),[B,{openModal:V}]=C(),[W,{openModal:z}]=C(),[G,{reload:J,setProps:L,updateTableDataRecord:Q,getRowSelection:X,clearSelectedRowKeys:Y,getSelectRows:Z,getForm:ee}]=o({title:"账号列表",api:s,rowKey:"id",columns:I,rowSelection:{type:"checkbox"},clickToRowSelect:!1,formConfig:{labelWidth:120,schemas:S},useSearchForm:!0,actionColumn:{width:240,title:"操作",dataIndex:"action"}});function te(){A(!0,{isUpdate:!1,isDetail:!1})}function ne(){z(!0,{})}function oe(e){A(!0,{record:e,isUpdate:!0,isDetail:!1})}function se(e){A(!0,{record:e,isUpdate:!1,isDetail:!0})}function ie(t){return e(this,null,(function*(){yield i({ids:t.id}),$("操作成功"),J()}))}function ae({isUpdate:e,values:t}){$("操作成功"),e?Q(t.id,t):J()}function re(){$("操作成功"),J()}function le(e=""){L({searchInfo:{deptId:e}}),J()}function ce(){const e=X().selectedRowKeys;0!=(null==e?void 0:e.length)?V(!0,{records:Z(),recordIds:e}):q("请至少选择一条数据")}function de(){const t=X().selectedRowKeys;null!=t&&0!=t.length?P({iconType:"warning",title:()=>x("span","确认"),content:()=>x("span","确定将选择账号密码重置为123456?"),onOk:()=>e(this,null,(function*(){yield a({userIds:t}),Y(),$("操作成功")}))}):q("请至少选择一条数据")}function ue(){const t=X().selectedRowKeys;null!=t&&0!=t.length?P({iconType:"warning",title:()=>x("span","确认"),content:()=>x("span","确定将选择账号解封?"),onOk:()=>e(this,null,(function*(){yield r({userIds:t}),Y(),$("操作成功")}))}):q("请至少选择一条数据")}function pe(){return e(this,null,(function*(){P({iconType:"warning",title:()=>x("span","确认"),content:()=>x("span","是否导出用户数据?"),onOk:()=>e(this,null,(function*(){const e=ee().getFieldsValue();U({url:`/api/blade-user/export-user?${_.tokenHeader}=${h().getToken}&account=${e.account?e.account:""}&realName=${e.realName?e.realName:""}`,fileName:"用户数据表.xlsx"})}))})}))}return(e,o)=>{const s=u("a-button"),i=p("auth");return m(),f(y(l),{dense:"",contentFullHeight:"",contentClass:"flex"},{default:b((()=>[g(c,{class:"w-1/4 xl:w-1/5",onSelect:le}),g(y(t),{onRegister:y(G),class:"w-3/4 xl:w-4/5"},{toolbar:b((()=>[j((m(),f(s,{type:"primary",onClick:te},{default:b((()=>[F])),_:1})),[[i,"user_add"]]),j((m(),f(s,{type:"info",onClick:ce,preIcon:"ant-design:user-outlined"},{default:b((()=>[O])),_:1})),[[i,"user_role"]]),j((m(),f(s,{type:"info",onClick:de,preIcon:"ant-design:key-outlined"},{default:b((()=>[K])),_:1})),[[i,"user_reset"]]),y(h)().getUserInfo.role_name.includes("admin")?(m(),f(s,{key:0,onClick:ue,preIcon:"ant-design:unlock-outlined"},{default:b((()=>[D])),_:1})):k("",!0),y(h)().getUserInfo.role_name.includes("admin")?(m(),f(s,{key:1,type:"primary",onClick:ne},{default:b((()=>[H])),_:1})):k("",!0),y(h)().getUserInfo.role_name.includes("admin")?(m(),f(s,{key:2,type:"success",onClick:pe},{default:b((()=>[N])),_:1})):k("",!0)])),bodyCell:b((({column:e,record:t})=>["action"===e.dataIndex?(m(),f(y(n),{key:0,actions:[{auth:"user_view",label:"查看",color:"success",icon:"clarity:info-standard-line",onClick:se.bind(null,t)},{auth:"user_edit",label:"编辑",icon:"clarity:note-edit-line",onClick:oe.bind(null,t)},{auth:"user_delete",label:"删除",icon:"ant-design:delete-outlined",color:"error",popConfirm:{title:"是否确认删除",confirm:ie.bind(null,t)}}]},null,8,["actions"])):k("",!0)])),_:1},8,["onRegister"]),g(v,{onRegister:y(E),onSuccess:ae},null,8,["onRegister"]),g(T,{onRegister:y(B),onSuccess:re},null,8,["onRegister"]),g(M,{onRegister:y(W),onSuccess:re},null,8,["onRegister"])])),_:1})}}});export{P as default};
