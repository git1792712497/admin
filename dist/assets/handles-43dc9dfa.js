var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,i=(t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,n=(e,t,s)=>new Promise(((a,o)=>{var r=e=>{try{n(s.next(e))}catch(t){o(t)}},i=e=>{try{n(s.throw(e))}catch(t){o(t)}},n=e=>e.done?a(e.value):Promise.resolve(e.value).then(r,i);n((s=s.apply(e,t)).next())}));import{u as l,B as c}from"./useForm-76a4ff23.js";import{a as u,dD as d,c8 as m,z as p,w as f,o as y,h as v,n as b,H as I,k as j,bn as h,L as g,dg as w,O as k,am as O,j as _,dE as x,i as P,t as C,l as T,K as A,cU as B,dC as D,S as F}from"./index-c5a6c875.js";import{a as E}from"./index-33df9098.js";import{h as N,a as R,c as q,d as S}from"./process-98643a44.js";import"./index-bb91fa2a.js";import"./isEqual-f9888ec4.js";import"./_baseIsEqual-f0bca653.js";import"./get-8f9589fb.js";import"./index-c9e02f09.js";import"./useWindowSizeFn-72c85a53.js";import"./FullscreenOutlined-9b414b92.js";import"./uuid-f62a8acd.js";import"./download-0641dcf7.js";import"./index-b52e0339.js";import"./uniqBy-e29b0e8a.js";import"./onMountedOrActivated-48cd1b25.js";import"./useContentViewHeight-e138bd2a.js";import"./user-a4458d91.js";const $=A("同意"),z=A("驳回"),H=A("关闭"),M={key:0},V={key:1},W={key:2},G=["src"],K=u({setup(e){const u=d.Item,{createMessage:A}=F(),K=m(),{currentRoute:L}=p(),U=f([]),J=f(),[Q,{validate:X,setFieldsValue:Y}]=l({labelWidth:100,baseColProps:{span:23},actionColOptions:{span:23},schemas:N,showActionButtonGroup:!1,showResetButton:!1,submitButtonOptions:{text:"提交"}});function Z(){return n(this,null,(function*(){const e=yield X(),t={taskId:L.value.params.taskId,processInstanceId:L.value.params.processInstanceId,flag:"ok",comment:e.comment};yield S(t),A.success("处理成功"),B(D).close(L.value),K("/work/start",!0)}))}function ee(){return n(this,null,(function*(){const e=yield X(),t={taskId:L.value.params.taskId,processInstanceId:L.value.params.processInstanceId,comment:e.comment};yield S(t),A.success("处理成功"),B(D).close(L.value),K("/work/start",!0)}))}function te(){B(D).close(L.value),K("/work/start",!0)}return function(){n(this,null,(function*(){J.value=`/api/blade-flow/process/diagram-view?processInstanceId=${L.value.params.processInstanceId}&t=${(new Date).getTime()}`;const e=yield R({businessId:L.value.params.businessId}),n=e.flow.assigneeName;var l;Y((l=((e,t)=>{for(var s in t||(t={}))o.call(t,s)&&i(e,s,t[s]);if(a)for(var s of a(t))r.call(t,s)&&i(e,s,t[s]);return e})({},e),t(l,s({assigneeName:n}))));const c=yield q({processInstanceId:L.value.params.processInstanceId});U.value=c}))}(),(e,t)=>(y(),v("div",null,[b(j(E),{title:"处理请假"},{rightFooter:I((()=>[b(j(h),null,{default:I((()=>[b(j(g),{type:"primary",onClick:Z},{default:I((()=>[$])),_:1}),b(j(g),{type:"primary",danger:"",onClick:ee},{default:I((()=>[z])),_:1}),b(j(g),{onClick:te},{default:I((()=>[H])),_:1})])),_:1})])),default:I((()=>[b(j(w),{title:"审批信息"},{default:I((()=>[b(j(c),{onRegister:j(Q)},null,8,["onRegister"])])),_:1}),b(j(w),{title:"流程信息"},{default:I((()=>[b(j(d),{mode:"left"},{default:I((()=>[(y(!0),v(k,null,O(U.value,(e=>(y(),_(j(u),{key:`${e.historyActivityId}`},{default:I((()=>[b(j(x),{title:e.createTime},{default:I((()=>[P("p",null,C(e.assigneeName)+" 在 ["+C(e.createTime)+"] 开始处理 ["+C(e.historyActivityName)+"] 环节",1),""!==e.historyActivityDurationTime?(y(),v("p",M,"任务历时 ["+C(e.historyActivityDurationTime)+"]",1)):T("",!0),""!==e.comment?(y(),v("p",V,"批复意见: ["+C(e.comment)+"]",1)):T("",!0),""!==e.endTime?(y(),v("p",W,"结束时间: ["+C(e.endTime)+"]",1)):T("",!0)])),_:2},1032,["title"])])),_:2},1024)))),128))])),_:1})])),_:1}),b(j(w),{title:"流程跟踪"},{default:I((()=>[P("img",{src:J.value,alt:"design"},null,8,G)])),_:1})])),_:1})]))}});export{K as default};
