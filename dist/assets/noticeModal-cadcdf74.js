var e=Object.defineProperty,t=Object.defineProperties,o=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,s=(t,o,a)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[o]=a,n=(e,t)=>{for(var o in t||(t={}))l.call(t,o)&&s(e,o,t[o]);if(a)for(var o of a(t))i.call(t,o)&&s(e,o,t[o]);return e},r=(e,a)=>t(e,o(a)),c=(e,t,o)=>new Promise(((a,l)=>{var i=e=>{try{n(o.next(e))}catch(t){l(t)}},s=e=>{try{n(o.throw(e))}catch(t){l(t)}},n=e=>e.done?a(e.value):Promise.resolve(e.value).then(i,s);n((o=o.apply(e,t)).next())}));import{s as d,a as p,w as m,k as u,f,ab as b,o as y,j as h,H as v,E as g,G as P,i as j,n as D,ag as O}from"./index-c5a6c875.js";import{B as w,a as F}from"./index-c9e02f09.js";import{B as T,u as x}from"./useForm-76a4ff23.js";import{g as M}from"./system-54dc9bf1.js";import{u as B}from"./attach-17a7a276.js";import{a as S,s as V}from"./notice-96969c64.js";import{D as k,u as I}from"./index-2c15cc4f.js";import{T as L}from"./index-327d6ea5.js";import{s as R}from"./region-dd8311c2.js";const U=[{title:"标题",dataIndex:"title"},{title:"类型",dataIndex:"category"},{title:"通知日期",dataIndex:"releaseTime"}],_=[{field:"title",label:"通知标题",component:"Input"},{field:"category",label:"通知类型",component:"ApiSelect",componentProps:{placeholder:"请选择通知类型",api:M,params:{code:"notice"},labelField:"dictValue",valueField:"dictKey"}}],q=[{field:"title",label:"标题",component:"Upload",rules:[{required:!0,message:"请选择上传文件"}],componentProps:()=>({api:B,multiple:!1}),colProps:{span:24}},{field:"category",label:"通知类型",component:"ApiSelect",componentProps:{placeholder:"请选择通知类型",api:M,params:{code:"notice"},labelField:"dictValue",valueField:"dictKey",stringToNumber:!0},required:!0},{field:"releaseTime",label:"通知日期",component:"DatePicker",componentProps:{showTime:!0,valueFormat:"YYYY-MM-DD HH:mm:ss",style:{width:"100%"}},required:!0},{field:"province",label:"省市区联动",component:"Cascader",colProps:{span:24},componentProps:{fieldNames:{label:"name",value:"code"}},required:!0},{field:"content",label:"内容",component:"Input",colProps:{span:24},slot:"content",required:!0}],E=[{field:"title",label:"标题"},{field:"category",label:"通知类型"},{field:"releaseTime",label:"通知日期"},{field:"content",label:"内容"}];const N=d(p({name:"NoticeModal",components:{BasicModal:w,BasicForm:T,Description:k,Tinymce:L},emits:["success","register"],setup(e,{emit:t}){const o=m(!0),a=m(!0),l=m(""),i=m(),[s,{setDescProps:d}]=I({schema:E}),[p,{setFieldsValue:b,resetFields:y,validate:h,updateSchema:v}]=x({labelWidth:100,schemas:q,showActionButtonGroup:!1,baseColProps:{span:12},actionColOptions:{span:23}}),[g,{setModalProps:P,closeModal:j}]=F((e=>c(this,null,(function*(){if(y(),P({confirmLoading:!1}),a.value=!!(null==e?void 0:e.isUpdate),o.value=!!(null==e?void 0:e.isDetail),u(o)){const t=yield S({id:e.record.id});d({data:t})}else{const t=yield R();if(t.forEach((e=>{e.isLeaf=!1})),i.value=t,v({field:"province",componentProps:{options:u(i),changeOnSelect:!0,loadData:e=>c(this,null,(function*(){const t=e[e.length-1],o=yield R({code:t.code});o.forEach((e=>{3!=e.regionLevel&&(e.isLeaf=!1)})),t.children=o,i.value=[...i.value]}))}}),u(a)){l.value=e.record.id;const t=yield S({id:e.record.id});b(r(n({},t),{title:t.title?[t.title]:[]}))}}}))));return{noticeModal:g,noticeForm:p,noticeDetail:s,getTitle:f((()=>u(a)?"编辑":"新增")),handleSubmit:function(){return c(this,null,(function*(){try{const e=yield h();P({confirmLoading:!0}),u(a)&&(e.id=l.value),yield V(e),j(),t("success",{isUpdate:u(a),values:r(n({},e),{id:l.value})})}finally{P({confirmLoading:!1})}}))},isUpdate:a,isDetail:o}}}),[["render",function(e,t,o,a,l,i){const s=b("Description"),n=b("Tinymce"),r=b("BasicForm"),c=b("BasicModal");return y(),h(c,O(e.$attrs,{onRegister:e.noticeModal,title:e.getTitle,onOk:e.handleSubmit,showOkBtn:!e.isDetail,width:900}),{default:v((()=>[g(j("div",null,[D(s,{show:"isDetail",size:"middle",onRegister:e.noticeDetail,column:2},null,8,["onRegister"])],512),[[P,e.isDetail]]),g(j("div",null,[D(r,{onRegister:e.noticeForm},{content:v((({model:e,field:t})=>[D(n,{modelValue:e[t],"onUpdate:modelValue":o=>e[t]=o,width:"100%"},null,8,["modelValue","onUpdate:modelValue"])])),_:1},8,["onRegister"])],512),[[P,!e.isDetail]])])),_:1},16,["onRegister","title","onOk","showOkBtn"])}]]),Y=Object.freeze(Object.defineProperty({__proto__:null,default:N},Symbol.toStringTag,{value:"Module"}));export{N,U as c,Y as n,_ as s};
