import{x as t,aw as e,Z as n,f as a,as as s,k as u,ap as o,w as r,au as l,a as i,L as c,s as d,c as f,ak as p,ab as v,o as m,j as y,H as C,K as b,t as g,ag as S,b as x,al as w,am as h,ad as z,an as B,ao as A,n as F,Y as j}from"./index-c5a6c875.js";import{i as k}from"./isEqual-f9888ec4.js";function T(r,l="value",i="change",c){const d=o(),f=null==d?void 0:d.emit,p=t({value:r[l]}),v=e(p);n((()=>{p.value=r[l]}));return[a({get:()=>p.value,set(t){k(t,v.value)||(p.value=t,null==f||f(i,t,...s(u(c))||[]))}}),t=>{p.value=t},v]}const $=d(i({name:"CountButton",components:{Button:c},props:{value:{type:[Object,Number,String,Array]},count:{type:Number,default:60},beforeStartFunc:{type:Function,default:null}},setup(t){const e=r(!1),{currentCount:s,isStart:o,start:i,reset:c}=function(t){const e=r(t),n=r(!1);let a;function s(){a&&window.clearInterval(a)}function o(){n.value=!1,s(),a=null}function i(){u(n)||a||(n.value=!0,a=setInterval((()=>{1===u(e)?(o(),e.value=t):e.value-=1}),1e3))}function c(){e.value=t,o()}return l((()=>{c()})),{start:i,reset:c,restart:function(){c(),i()},clear:s,stop:o,currentCount:e,isStart:n}}(t.count),{t:d}=f(),v=a((()=>u(o)?d("component.countdown.sendText",[u(s)]):d("component.countdown.normalText")));return n((()=>{void 0===t.value&&c()})),{handleStart:function(){return n=this,a=null,s=function*(){const{beforeStartFunc:n}=t;if(n&&p(n)){e.value=!0;try{(yield n())&&i()}finally{e.value=!1}}else i()},new Promise(((t,e)=>{var u=t=>{try{r(s.next(t))}catch(n){e(n)}},o=t=>{try{r(s.throw(t))}catch(n){e(n)}},r=e=>e.done?t(e.value):Promise.resolve(e.value).then(u,o);r((s=s.apply(n,a)).next())}));var n,a,s},currentCount:s,loading:e,getButtonText:v,isStart:o}}}),[["render",function(t,e,n,a,s,u){const o=v("Button");return m(),y(o,S(t.$attrs,{disabled:t.isStart,onClick:t.handleStart,loading:t.loading}),{default:C((()=>[b(g(t.getButtonText),1)])),_:1},16,["disabled","onClick","loading"])}]]);const I=j(d(i({name:"CountDownInput",components:{CountButton:$},inheritAttrs:!1,props:{value:{type:String},size:{type:String,validator:t=>["default","large","small"].includes(t)},count:{type:Number,default:60},sendCodeApi:{type:Function,default:null}},setup(t){const{prefixCls:e}=x("countdown-input"),[n]=T(t);return{prefixCls:e,state:n}}}),[["render",function(t,e,n,a,s,u){const o=v("CountButton"),r=v("a-input");return m(),y(r,S(t.$attrs,{class:t.prefixCls,size:t.size,value:t.state}),w({addonAfter:C((()=>[F(o,{size:t.size,count:t.count,value:t.state,beforeStartFunc:t.sendCodeApi},null,8,["size","count","value","beforeStartFunc"])])),_:2},[h(Object.keys(t.$slots).filter((t=>"addonAfter"!==t)),(e=>({name:e,fn:C((n=>[z(t.$slots,e,B(A(n||{})))]))})))]),1040,["class","size","value"])}]]));j($);export{I as C,T as u};
