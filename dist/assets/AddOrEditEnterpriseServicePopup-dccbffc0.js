var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(a,l,r)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[l]=r,u=(e,a)=>{for(var l in a||(a={}))t.call(a,l)&&o(e,l,a[l]);if(r)for(var l of r(a))n.call(a,l)&&o(e,l,a[l]);return e},s=(e,r)=>a(e,l(r)),i=(e,a,l)=>new Promise(((r,t)=>{var n=e=>{try{u(l.next(e))}catch(a){t(a)}},o=e=>{try{u(l.throw(e))}catch(a){t(a)}},u=e=>e.done?r(e.value):Promise.resolve(e.value).then(n,o);u((l=l.apply(e,a)).next())}));import{u as d,B as c}from"./index-c9e02f09.js";import{bo as p,a as v,eg as m,w as f,ab as b,o as g,j as h,H as w,n as y,k as _,h as I,am as O,K as j,t as x,O as z,as as P,eh as U}from"./index-c5a6c875.js";import q from"./ImageUpload-f0074c94.js";const V={name:[{required:!0,message:"栏目名称是必填项",trigger:"blur",whitespace:!0}],websiteId:[{required:!0,message:"站点名称是必选项",trigger:"blur"}],enterpriseId:[{required:!0,message:"企业名称是必选项",trigger:"blur"}],subtitle:[{required:!0,message:"副标题是必填项",trigger:"blur",whitespace:!0}]};function C(e){var a,l;return p.post({url:"/enterprise/query",params:s(u({pagination:{size:null!=(a=null==e?void 0:e.size)?a:10,current:null!=(l=null==e?void 0:e.current)?l:1}},e),{size:void 0,current:void 0})})}function R(e){var a,l;return p.post({url:"/enterprise-service/query",params:s(u({pagination:{size:null!=(a=null==e?void 0:e.size)?a:10,current:null!=(l=null==e?void 0:e.current)?l:1}},e),{size:void 0,current:void 0})})}function S(e){return p.get({url:"/enterprise-service/tree",params:e})}function k(e){return p.delete({url:`/enterprise-service/destroy/${e}`})}const E=v({emits:["success"],setup(e,{expose:a,emit:l}){const[r,{openModal:t}]=d();let n=m(!1),o=f({});const v=m(),R=()=>i(this,null,(function*(){yield v.value.validate();const e=P(_(o.value));n.value=!0;try{yield(a=e,p.post({url:"/enterprise-service/save",params:a})),U.success("操作成功"),l("success")}finally{n.value=!1,t(!1)}var a}));let k=m([]);const E=m([]);let N=m([]);const A=e=>{const a=k.value.find((a=>a.id===e));o.value.websiteName=a.name,o.value.websiteDomain=a.domain};return a({openAddOrEditEnterpriseServicePopup:e=>i(this,null,(function*(){o.value=e,t();const a=yield Promise.all([(l={},p.post({url:"/website/query",params:s(u({pagination:{size:null!=(r=null==l?void 0:l.size)?r:10,current:null!=(n=null==l?void 0:l.current)?n:1}},l),{size:void 0,current:void 0})})),C(),S()]);var l,r,n;k.value=a.at(0).records,N.value=a.at(1).records,E.value=a.at(2).records}))}),(e,a)=>{const l=b("a-select-option"),t=b("a-select"),u=b("a-form-item"),s=b("a-input"),i=b("a-tree-select"),d=b("a-textarea"),p=b("a-form");return g(),h(_(c),{confirmLoading:_(n),forceRender:"",title:_(o).id?"修改企业服务":"新增企业服务",onOk:R,onRegister:_(r)},{default:w((()=>[y(p,{ref_key:"formRef",ref:v,"label-col":{span:4},model:_(o),rules:_(V)},{default:w((()=>[y(u,{label:"站点名称",name:"websiteId"},{default:w((()=>[y(t,{onChange:A,value:_(o).websiteId,"onUpdate:value":a[0]||(a[0]=e=>_(o).websiteId=e),placeholder:"请选择站点"},{default:w((()=>[(g(!0),I(z,null,O(_(k),(e=>(g(),h(l,{value:e.id},{default:w((()=>[j(x(e.name),1)])),_:2},1032,["value"])))),256))])),_:1},8,["value"])])),_:1}),y(u,{label:"企业名称",name:"enterpriseId"},{default:w((()=>[y(t,{value:_(o).enterpriseId,"onUpdate:value":a[1]||(a[1]=e=>_(o).enterpriseId=e),placeholder:"请选择企业"},{default:w((()=>[(g(!0),I(z,null,O(_(N),(e=>(g(),h(l,{value:e.id},{default:w((()=>[j(x(e.name),1)])),_:2},1032,["value"])))),256))])),_:1},8,["value"])])),_:1}),y(u,{label:"名称",name:"name"},{default:w((()=>[y(s,{value:_(o).name,"onUpdate:value":a[2]||(a[2]=e=>_(o).name=e),"allow-clear":"",placeholder:"请输入企业服务名称"},null,8,["value"])])),_:1}),y(u,{label:"副标题",name:"subtitle"},{default:w((()=>[y(s,{value:_(o).subtitle,"onUpdate:value":a[3]||(a[3]=e=>_(o).subtitle=e),"allow-clear":"",placeholder:"请输入企业服务副标题"},null,8,["value"])])),_:1}),y(u,{label:"上级分类",name:"parentId"},{default:w((()=>[y(i,{onChange:a[4]||(a[4]=(e,a)=>_(o).columnName=a.pop()),value:_(o).parentId,"onUpdate:value":a[5]||(a[5]=e=>_(o).parentId=e),fieldNames:{children:"children",label:"name",value:"id"},"show-search":"","dropdown-style":{maxHeight:"400px",overflow:"auto"},placeholder:"请选择所属企业服务","allow-clear":"","tree-data":_(E)},null,8,["value","tree-data"])])),_:1}),y(u,{label:"图标",name:"icon"},{default:w((()=>[y(q,{modelValue:_(o).icon,"onUpdate:modelValue":a[6]||(a[6]=e=>_(o).icon=e)},null,8,["modelValue"])])),_:1}),y(u,{label:"封面图",name:"coverImage"},{default:w((()=>[y(q,{modelValue:_(o).coverImage,"onUpdate:modelValue":a[7]||(a[7]=e=>_(o).coverImage=e)},null,8,["modelValue"])])),_:1}),y(u,{label:"描述",name:"description"},{default:w((()=>[y(d,{value:_(o).description,"onUpdate:value":a[8]||(a[8]=e=>_(o).description=e),maxlength:255,rows:3,allowClear:"",placeholder:"请输入文章内容简介",showCount:""},null,8,["value"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["confirmLoading","title","onRegister"])}}}),N=Object.freeze(Object.defineProperty({__proto__:null,default:E},Symbol.toStringTag,{value:"Module"}));export{N as A,E as _,k as a,R as g};
