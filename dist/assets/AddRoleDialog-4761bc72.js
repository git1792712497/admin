var g=(y,_,n)=>new Promise((s,m)=>{var t=o=>{try{d(n.next(o))}catch(u){m(u)}},p=o=>{try{d(n.throw(o))}catch(u){m(u)}},d=o=>o.done?s(o.value):Promise.resolve(o.value).then(t,p);d((n=n.apply(y,_)).next())});import{w as F,x as M,T,y as N,A as U,Q as q,l as x}from"./element-plus-3c3e7816.js";import{g as L}from"./index-3064f8b9.js";import{g as $,c as G}from"./menu-2a3ae1f5.js";import{F as Q,r as v,q as S,s as X,ao as j,o as h,$ as E,a0 as l,a as z,a2 as r,ac as R,X as H,u as a,G as J}from"./@vue-0bd7c233.js";import{_ as K}from"./_plugin-vue_export-helper-c27b6911.js";import"./lodash-unified-cbbf5a2b.js";import"./lodash-d8f670e1.js";import"./@amap-9fd45ac7.js";import"./@sxzz-ad8bfd58.js";import"./@vueuse-b3c2dc13.js";import"./@element-plus-9f43ecf9.js";import"./dayjs-604b50be.js";import"./async-validator-f102eabc.js";import"./@ctrl-83f18216.js";import"./escape-html-12e99df8.js";import"./normalize-wheel-es-c175a4cf.js";import"./vue-171b62d6.js";import"./@floating-ui-5f39704e.js";import"./memoize-one-0650c7b0.js";import"./pinia-c63b1ff9.js";import"./vue-demi-71ba0ef2.js";import"./axios-226f391c.js";import"./qs-b010a38c.js";import"./side-channel-a082fe58.js";import"./get-intrinsic-5660d814.js";import"./has-symbols-8f82dcae.js";import"./function-bind-22e7ee79.js";import"./has-26d28e02.js";import"./call-bind-75c15918.js";import"./object-inspect-4572ba77.js";import"./preload-helper-41c905a7.js";import"./vue-router-169b55e4.js";import"./nprogress-57f984c9.js";import"./lodash-es-81e82e73.js";const O={name:[{type:"string",required:!0,message:"角色名称是必填项",trigger:"blur"}]},P={class:"dialog-footer"},W=Q({__name:"AddRoleDialog",emits:["refresh"],setup(y,{expose:_,emit:n}){const s=v(!1),m=v();let t=S({menuId:[]}),p=v(!1);const d=()=>{m.value.validate(c=>g(this,null,function*(){if(!!c){p.value=!0;try{const{message:e}=yield L(J(t));x.ElMessage({message:e,type:"success"}),n("refresh"),b()}catch(e){x.ElMessage({message:"创建失败",type:"error"})}finally{p.value=!1}}}))};let o=X([]);const u=()=>g(this,null,function*(){s.value=!0;const{data:c}=yield $();o.value=G(c)}),b=()=>s.value=!1;return _({openDialog:u,closeDialog:b}),(c,e)=>{const V=F,f=M,k=T,D=N,w=U,A=q,C=j("auth");return h(),E(A,{modelValue:s.value,"onUpdate:modelValue":e[4]||(e[4]=i=>s.value=i),title:"新增角色",width:"30%"},{footer:l(()=>[z("span",P,[r(w,{onClick:e[3]||(e[3]=i=>s.value=!1)},{default:l(()=>[R("取消")]),_:1}),H((h(),E(w,{type:"primary",loading:a(p),onClick:d},{default:l(()=>[R(" 确定 ")]),_:1},8,["loading"])),[[C,["addRole"]]])])]),default:l(()=>[r(D,{ref_key:"formRef",ref:m,model:a(t),"status-icon":"",rules:a(O),"label-width":"80px"},{default:l(()=>[r(f,{label:"角色名称",prop:"name"},{default:l(()=>[r(V,{modelValue:a(t).name,"onUpdate:modelValue":e[0]||(e[0]=i=>a(t).name=i),clearable:"",autofocus:"",placeholder:"请输入角色名称"},null,8,["modelValue"])]),_:1}),r(f,{label:"角色描述",prop:"description"},{default:l(()=>[r(V,{modelValue:a(t).description,"onUpdate:modelValue":e[1]||(e[1]=i=>a(t).description=i),max:255,rows:1,type:"textarea",placeholder:"请输入角色描述"},null,8,["modelValue"])]),_:1}),r(f,{label:"菜单权限",prop:"menuId"},{default:l(()=>[r(k,{onCheck:e[2]||(e[2]=(i,{checkedKeys:I,halfCheckedKeys:B})=>a(t).menuId=[...I,...B]),"node-key":"id",data:a(o),multiple:"","show-checkbox":"",clearable:"",props:{label:"title",children:"children",value:"id"},style:{width:"100%"}},null,8,["data"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}});const Me=K(W,[["__scopeId","data-v-3724dbe3"]]);export{Me as default};
