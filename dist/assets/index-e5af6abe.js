var e=(e,t,o)=>new Promise(((s,a)=>{var n=e=>{try{i(o.next(e))}catch(t){a(t)}},r=e=>{try{i(o.throw(e))}catch(t){a(t)}},i=e=>e.done?s(e.value):Promise.resolve(e.value).then(n,r);i((o=o.apply(e,t)).next())}));import{s as t,a as o,da as s,ci as a,ct as n,ax as r,b as i,v as c,c8 as l,f as d,ab as u,o as p,h as m,n as f,H as g,j as h,l as k,i as x,q as j,t as b,O as _,c as y,S as D,ca as w,bX as I}from"./index-c5a6c875.js";import{D as S}from"./siteSetting-1eee86c7.js";import{c as v,u as M}from"./index-75a8f9cd.js";import{u as C}from"./index-c9e02f09.js";import{h as U}from"./header-e7a2da68.js";import L from"./UserInfoSelectModal-484cf3af.js";import"./uniqBy-e29b0e8a.js";import"./_baseIsEqual-f0bca653.js";import"./get-8f9589fb.js";import"./FullscreenOutlined-9b414b92.js";import"./index-120481e4.js";import"./useWindowSizeFn-72c85a53.js";import"./useContentViewHeight-e138bd2a.js";import"./RedoOutlined-e07a9f51.js";import"./lock-bbc913c9.js";import"./dict-5f910412.js";import"./system-54dc9bf1.js";import"./validate-e879236f.js";import"./isEqual-f9888ec4.js";import"./useForm-76a4ff23.js";import"./index-bb91fa2a.js";import"./uuid-f62a8acd.js";import"./download-0641dcf7.js";import"./index-b52e0339.js";import"./dept-667428a4.js";import"./role-ff1ea5b0.js";const E=o({name:"UserDropdown",components:{UserInfoSelectModal:L,Dropdown:s,Menu:a,MenuItem:v((()=>n((()=>import("./DropMenuItem-2ba4478b.js")),["./DropMenuItem-2ba4478b.js","./index-c5a6c875.js","./index-6aa08860.css"],import.meta.url))),MenuDivider:a.Divider,LockAction:v((()=>n((()=>import("./LockModal-7b84d8a9.js")),["./LockModal-7b84d8a9.js","./index-c5a6c875.js","./index-6aa08860.css","./index-c9e02f09.js","./useWindowSizeFn-72c85a53.js","./FullscreenOutlined-9b414b92.js","./isEqual-f9888ec4.js","./_baseIsEqual-f0bca653.js","./index-d0b877f3.css","./useForm-76a4ff23.js","./index-bb91fa2a.js","./index-7b8b5e30.css","./get-8f9589fb.js","./uuid-f62a8acd.js","./download-0641dcf7.js","./index-b52e0339.js","./index-88b1d373.css","./uniqBy-e29b0e8a.js","./useForm-06d2c65c.css","./lock-bbc913c9.js","./header-e7a2da68.js","./LockModal-0068f88c.css"],import.meta.url)))},props:{theme:r.oneOf(["dark","light"])},setup(){const{prefixCls:t}=i("header-user-dropdown"),{t:o}=y(),{getShowDoc:s,getUseLockPage:a}=M(),n=c(),r=l(),{createMessage:u}=D(),p=d((()=>{const{nick_name:e="",avatar:t}=n.getUserInfo||{};return{nick_name:e,avatar:t||U}})),[m,{openModal:f}]=C(),[g,{openModal:h}]=C();return{prefixCls:t,t:o,getUserInfo:p,handleMenuClick:function(e){switch(e.key){case"userSetting":r(w.USER_SETTING);break;case"changeDept":f(!0,{user_id:n.getUserInfo.user_id});break;case"logout":n.confirmLoginOut();break;case"doc":I(S);break;case"lock":h(!0)}},handleSuccess:function(t){return e(this,arguments,(function*({values:e}){yield c().refreshTokens(e.deptId,e.roleId),u.success("切换成功")}))},changeDeptModal:m,getShowDoc:s,register:g,getUseLockPage:a}}}),O=["src"];const R=t(E,[["render",function(e,t,o,s,a,n){const r=u("MenuItem"),i=u("MenuDivider"),c=u("Menu"),l=u("Dropdown"),d=u("LockAction"),y=u("UserInfoSelectModal");return p(),m(_,null,[f(l,{placement:"bottomLeft",overlayClassName:`${e.prefixCls}-dropdown-overlay`},{overlay:g((()=>[f(c,{onClick:e.handleMenuClick},{default:g((()=>[f(r,{key:"userSetting",text:e.t("layout.header.userSetting"),icon:"ant-design:user-outlined"},null,8,["text"]),f(r,{key:"changeDept",text:e.t("layout.header.changeDept"),icon:"ant-design:swap-outlined"},null,8,["text"]),e.getShowDoc?(p(),h(r,{key:"doc",text:e.t("layout.header.dropdownItemDoc"),icon:"ion:document-text-outline"},null,8,["text"])):k("",!0),e.getShowDoc?(p(),h(i,{key:1})):k("",!0),e.getUseLockPage?(p(),h(r,{key:"lock",text:e.t("layout.header.tooltipLock"),icon:"ion:lock-closed-outline"},null,8,["text"])):k("",!0),f(r,{key:"logout",text:e.t("layout.header.dropdownItemLoginOut"),icon:"ion:power-outline"},null,8,["text"])])),_:1},8,["onClick"])])),default:g((()=>[x("span",{class:j([[e.prefixCls,`${e.prefixCls}--${e.theme}`],"flex"])},[x("img",{class:j(`${e.prefixCls}__header`),src:e.getUserInfo.avatar},null,10,O),x("span",{class:j(`${e.prefixCls}__info hidden md:block`)},[x("span",{class:j([`${e.prefixCls}__name  `,"truncate"])},b(e.getUserInfo.nick_name),3)],2)],2)])),_:1},8,["overlayClassName"]),f(d,{onRegister:e.register},null,8,["onRegister"]),f(y,{onRegister:e.changeDeptModal,onSuccess:e.handleSuccess},null,8,["onRegister","onSuccess"])],64)}]]);export{R as default};
