var S=Object.defineProperty,N=Object.defineProperties;var B=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var w=(o,e,t)=>e in o?S(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,b=(o,e)=>{for(var t in e||(e={}))C.call(e,t)&&w(o,t,e[t]);if(_)for(var t of _(e))T.call(e,t)&&w(o,t,e[t]);return o},x=(o,e)=>N(o,B(e));var u=(o,e,t)=>new Promise((s,a)=>{var r=l=>{try{n(t.next(l))}catch(p){a(p)}},c=l=>{try{n(t.throw(l))}catch(p){a(p)}},n=l=>l.done?s(l.value):Promise.resolve(l.value).then(r,c);n((t=t.apply(o,e)).next())});import{A as D,G as F,h as O,c as L,H as A,I as P,B as V}from"./element-plus-ef60ab81.js";import{r as H,u as g,w as R}from"./xlsx-ec0d7d13.js";import{i as W}from"./lodash-es-81e82e73.js";import{b as $}from"./fastMock-97bfdc48.js";import{F as E,e as q,o as G,$ as I,a0 as m,a as y,a2 as i,ac as d,u as J}from"./@vue-46cd96cd.js";import"./lodash-unified-cbbf5a2b.js";import"./lodash-d8f670e1.js";import"./@amap-9fd45ac7.js";import"./@sxzz-ad8bfd58.js";import"./@vueuse-c4efa120.js";import"./@element-plus-32e4db1a.js";import"./async-validator-f102eabc.js";import"./@ctrl-83f18216.js";import"./escape-html-12e99df8.js";import"./normalize-wheel-es-c175a4cf.js";import"./vue-bd17b2e0.js";import"./@floating-ui-5f39704e.js";import"./dayjs-7cbd9aff.js";import"./memoize-one-0650c7b0.js";import"./index-6920edb1.js";import"./preload-helper-41c905a7.js";import"./vue-router-e8f17689.js";import"./nprogress-57f984c9.js";import"./pinia-2c3c5428.js";import"./vue-demi-71ba0ef2.js";import"./axios-226f391c.js";import"./qs-b010a38c.js";import"./side-channel-a082fe58.js";import"./get-intrinsic-5660d814.js";import"./has-symbols-8f82dcae.js";import"./function-bind-22e7ee79.js";import"./has-26d28e02.js";import"./call-bind-75c15918.js";import"./object-inspect-4572ba77.js";function M(o,e){const t=new FileReader;return t.readAsArrayBuffer(o),new Promise(s=>{t.onload=a=>{const r=a.target.result,c=H(r,{type:"array"}),n=c.SheetNames[0],l=c.Sheets[n],p=g.sheet_to_json(l);s(U(p,e))}})}function U(o,e){const t=[],s=W(e);return o.forEach(a=>{let r={};Object.keys(a).forEach(c=>{s[c]&&(r[s[c]]=a[c])}),t.push(r)}),t}function z(o){if(o)if(/.*[\u4e00-\u9fa5]+.*$/.test(o)){const e=o.match(/[\u4e00-\u9fa5]/g).length,t=o.length-e;return e*2.1+t*1.2}else return o=o.toString(),o.replace(/[\u0391-\uFFE5]/g,"aa").length;else return 4}function K(o,e,t=4){const s={};e["!cols"]=[],o.forEach(a=>{Object.keys(a).forEach(r=>{var n;const c=a[r];s[r]=Math.max((n=s[r])!=null?n:t,z(c))})}),Object.keys(s).forEach(a=>{e["!cols"].push({wch:s[a]})})}function Q({data:o,header:e,filename:t="表.xlsx",json2sheetOpts:s={},write2excelOpts:a={bookType:"xlsx"}}){let r=[...o];for(let l in e)e[l]||delete e[l];Object.keys(e).length&&(r=o.map(l=>{let p={};for(let h in e)p[h]=l[h];return p}),r.unshift(e),s.skipHeader=!0);const c=g.json_to_sheet(r,s);K(r,c);const n={SheetNames:[t],Sheets:{[t]:c}};R(n,t,a)}const X={class:"flex justify-between"},Y={class:"flex justify-between"},Z=E({name:"excel"}),Ae=E(x(b({},Z),{setup(o){let e=q([]);const t={orderNo:"订单编号",orderDate:"下单时间",address:"详细地址",receiver:"收件人",receiverPhone:"收件人电话"},s=c=>u(this,[c],function*({file:r}){console.time("导入时间");const n=yield M(r,t);console.log(n,"导入"),console.timeEnd("导入时间"),e.value.push(...n)}),a=()=>u(this,null,function*(){const r=yield $();console.log(r),console.time("下载时间"),Q({data:[...r,...e.value],header:t}),console.timeEnd("下载时间")});return(r,c)=>{const n=D,l=F,p=O,h=L,f=A,k=P,j=V;return G(),I(j,{shadow:"hover"},{header:m(()=>[y("nav",X,[i(p,null,{default:m(()=>[i(l,{"http-request":s,"show-file-list":!1},{trigger:m(()=>[i(n,{type:"primary"},{default:m(()=>[d("excel导入")]),_:1})]),_:1}),i(n,{type:"primary",onClick:a},{default:m(()=>[d("excel导出")]),_:1})]),_:1}),y("div",Y,[i(h,{href:"https://www.npmjs.com/package/xlsx",target:"_blank",type:"primary"},{default:m(()=>[d("excel导入导出")]),_:1})])])]),default:m(()=>[i(k,{data:J(e),"row-key":v=>v.orderNo,border:"","highlight-current-row":"",stripe:""},{default:m(()=>[i(f,{label:"订单编号",prop:"orderNo","show-overflow-tooltip":"",width:"250"}),i(f,{label:"下单时间",prop:"orderDate","show-overflow-tooltip":"",width:"180"}),i(f,{label:"详细地址",prop:"address","show-overflow-tooltip":""}),i(f,{label:"收件人",prop:"receiver","show-overflow-tooltip":""}),i(f,{label:"收件人电话",prop:"receiverPhone","show-overflow-tooltip":""})]),_:1},8,["data","row-key"])]),_:1})}}}));export{Ae as default};
