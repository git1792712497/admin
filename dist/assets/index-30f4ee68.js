import{B as e}from"./TableImg-d2c728a3.js";import{T as o}from"./useForm-76a4ff23.js";import{u as a}from"./useTable-0a379cac.js";import{c as s,a as t}from"./work-d99648b5.js";import{a as i,c8 as n,o as r,h as l,n as c,H as d,O as m,K as p,t as u,l as f,j as b,k as j,cP as I,S as g}from"./index-c5a6c875.js";import{u as w}from"./index-c9e02f09.js";import k from"./IframeModal-56501107.js";import{g as h}from"./system-54dc9bf1.js";import{a as x}from"./flow-a40dbf2f.js";import{u as y}from"./dict-5f910412.js";import"./index-33df9098.js";import"./onMountedOrActivated-48cd1b25.js";import"./useWindowSizeFn-72c85a53.js";import"./useContentViewHeight-e138bd2a.js";import"./CheckOutlined-752df576.js";import"./isEqual-f9888ec4.js";import"./_baseIsEqual-f0bca653.js";import"./uuid-f62a8acd.js";import"./merge-5148c4a3.js";import"./get-8f9589fb.js";import"./sortable.esm-7c85b602.js";import"./RedoOutlined-e07a9f51.js";import"./FullscreenOutlined-9b414b92.js";import"./index-bb91fa2a.js";import"./download-0641dcf7.js";import"./index-b52e0339.js";import"./uniqBy-e29b0e8a.js";const v=[{title:"流程名称",dataIndex:"processDefinitionName"},{title:"当前步骤",dataIndex:"taskName"},{title:"流程版本",dataIndex:"processDefinitionVersion"},{title:"申请时间",dataIndex:"createTime"}],C=[{field:"category",label:"流程分类",component:"ApiSelect",colProps:{span:8},componentProps:{api:h,params:{code:"flow"},labelField:"dictValue",valueField:"dictKey"}},{field:"name",label:"流程名称",component:"Input",colProps:{span:8}}],_=i({setup(i){const{createMessage:h,createConfirm:_}=g(),[F,{openModal:O}]=w(),P=n(),[R,{reload:T}]=a({api:s,columns:v,formConfig:{labelWidth:120,schemas:C},useSearchForm:!0,actionColumn:{width:250,title:"操作",dataIndex:"action"}});function V(e){_({iconType:"warning",title:()=>I("span","提醒"),content:()=>I("span","确定签收此任务?"),onOk:()=>{return o=this,a=null,s=function*(){yield t({taskId:e.taskId}),h.success("操作成功"),T()},new Promise(((e,t)=>{var i=e=>{try{r(s.next(e))}catch(o){t(o)}},n=e=>{try{r(s.throw(e))}catch(o){t(o)}},r=o=>o.done?e(o.value):Promise.resolve(o.value).then(i,n);r((s=s.apply(o,a)).next())}));var o,a,s}})}function D(e){P(`/work/process/${x(y().getFlowRouter,e.category)}/detail/${e.processInstanceId}/${e.businessId}`)}function M(e){O(!0,{url:`/api/blade-flow/process/diagram-view?processInstanceId=${e.processInstanceId}`})}return(a,s)=>(r(),l("div",null,[c(j(e),{onRegister:j(R)},{bodyCell:d((({column:e,record:a})=>["processDefinitionVersion"===e.dataIndex?(r(),l(m,{key:0},[p(" v"+u(a.processDefinitionVersion),1)],64)):f("",!0),"action"===e.dataIndex?(r(),b(j(o),{key:1,actions:[{auth:"work_claim_sign",label:"签收",icon:"clarity:note-edit-line",onClick:V.bind(null,a)},{auth:"work_claim_detail",label:"查看",color:"success",icon:"clarity:info-standard-line",onClick:D.bind(null,a)},{auth:"work_claim_follow",label:"跟踪",icon:"ant-design:picture-filled",onClick:M.bind(null,a)}]},null,8,["actions"])):f("",!0)])),_:1},8,["onRegister"]),c(k,{onRegister:j(F)},null,8,["onRegister"])]))}});export{_ as default};
