import{B as e}from"./TableImg-d2c728a3.js";import{T as o}from"./useForm-76a4ff23.js";import{u as a}from"./useTable-0a379cac.js";import{g as l,r as n}from"./flow-db406d19.js";import{u as t}from"./index-c9e02f09.js";import s from"./IframeModal-56501107.js";import{D as i,c as d,s as r}from"./DeployModal-29817af6.js";import{s as c,a as u,ab as m,ac as p,o as f,h as b,n as h,H as j,E as g,j as w,l as y,y as M,K as C,S as D}from"./index-c5a6c875.js";import"./index-33df9098.js";import"./onMountedOrActivated-48cd1b25.js";import"./useWindowSizeFn-72c85a53.js";import"./useContentViewHeight-e138bd2a.js";import"./CheckOutlined-752df576.js";import"./isEqual-f9888ec4.js";import"./_baseIsEqual-f0bca653.js";import"./uuid-f62a8acd.js";import"./merge-5148c4a3.js";import"./get-8f9589fb.js";import"./sortable.esm-7c85b602.js";import"./RedoOutlined-e07a9f51.js";import"./FullscreenOutlined-9b414b92.js";import"./index-bb91fa2a.js";import"./download-0641dcf7.js";import"./index-b52e0339.js";import"./uniqBy-e29b0e8a.js";import"./system-54dc9bf1.js";import"./flow-a40dbf2f.js";const _=u({name:"FlowModel",components:{BasicTable:e,IframeModal:s,TableAction:o,DeployModal:i},setup(){const{createMessage:e}=D(),{success:o}=e,[s,{openModal:i}]=t(),[c,{openModal:u}]=t(),[m,{reload:p}]=a({api:l,rowKey:"id",columns:d,formConfig:{labelWidth:120,schemas:r},useSearchForm:!0,actionColumn:{width:300,title:"操作",dataIndex:"action"}});return{registeTable:m,registerModal:s,deployModal:c,handleCreate:function(){i(!0,{url:M.flowDesignUrl+"/index.html"})},handleDeploy:function(e){u(!0,{record:e})},handleDownload:function(e){window.open(M.flowDesignUrl+`/app/rest/models/${e.id}/bpmn20`)},handleDelete:function(e){return a=this,l=null,t=function*(){yield n({ids:e.id}),o("操作成功"),p()},new Promise(((e,o)=>{var n=e=>{try{i(t.next(e))}catch(a){o(a)}},s=e=>{try{i(t.throw(e))}catch(a){o(a)}},i=o=>o.done?e(o.value):Promise.resolve(o.value).then(n,s);i((t=t.apply(a,l)).next())}));var a,l,t},handleSuccess:function(){o("操作成功"),p()},handleUpdate:function(e){i(!0,{url:M.flowDesignUrl+`/index.html#/editor/${e.id}`})}}}}),x=C(" 创建 ");const S=c(_,[["render",function(e,o,a,l,n,t){const s=m("a-button"),i=m("TableAction"),d=m("BasicTable"),r=m("IframeModal"),c=m("DeployModal"),u=p("auth");return f(),b("div",null,[h(d,{onRegister:e.registeTable},{toolbar:j((()=>[g((f(),w(s,{type:"primary",onClick:e.handleCreate},{default:j((()=>[x])),_:1},8,["onClick"])),[[u,"flow_model_create"]])])),bodyCell:j((({column:o,record:a})=>["action"===o.dataIndex?(f(),w(i,{key:0,actions:[{auth:"flow_model_update",label:"配置",icon:"ant-design:setting-outlined",onClick:e.handleUpdate.bind(null,a)},{auth:"flow_model_deploy",label:"部署",icon:"ant-design:rocket-outlined",onClick:e.handleDeploy.bind(null,a)},{auth:"flow_model_download",label:"下载",icon:"clarity:download-cloud-line",onClick:e.handleDownload.bind(null,a)},{auth:"flow_model_delete",label:"删除",icon:"ant-design:delete-outlined",color:"error",popConfirm:{title:"是否确认删除",confirm:e.handleDelete.bind(null,a)}}]},null,8,["actions"])):y("",!0)])),_:1},8,["onRegister"]),h(r,{onRegister:e.registerModal,onSuccess:e.handleSuccess},null,8,["onRegister","onSuccess"]),h(c,{onRegister:e.deployModal,onSuccess:e.handleSuccess},null,8,["onRegister","onSuccess"])])}]]);export{S as default};
