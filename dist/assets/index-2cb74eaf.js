import{B as e}from"./TableImg-d2c728a3.js";import{T as a}from"./useForm-76a4ff23.js";import{u as o}from"./useTable-0a379cac.js";import{m as t,e as n}from"./flow-db406d19.js";import{s,a as i,b2 as r,w as l,B as d,ab as c,o as u,h as m,n as f,H as p,O as b,K as g,t as j,l as h,j as v,S as M}from"./index-c5a6c875.js";import{u as w}from"./index-c9e02f09.js";import{M as I,c as y,s as x}from"./ManagerModal-9126680f.js";import R from"./IframeModal-56501107.js";import"./index-33df9098.js";import"./onMountedOrActivated-48cd1b25.js";import"./useWindowSizeFn-72c85a53.js";import"./useContentViewHeight-e138bd2a.js";import"./CheckOutlined-752df576.js";import"./isEqual-f9888ec4.js";import"./_baseIsEqual-f0bca653.js";import"./uuid-f62a8acd.js";import"./merge-5148c4a3.js";import"./get-8f9589fb.js";import"./sortable.esm-7c85b602.js";import"./RedoOutlined-e07a9f51.js";import"./FullscreenOutlined-9b414b92.js";import"./index-bb91fa2a.js";import"./download-0641dcf7.js";import"./index-b52e0339.js";import"./uniqBy-e29b0e8a.js";import"./system-54dc9bf1.js";const _=i({name:"FlowManager",components:{BasicTable:e,ManagerModal:I,TableAction:a,IframeModal:R,RadioGroup:r.Group,RadioButton:r.Button},setup(){const e=l("1"),{createMessage:a}=M(),[s,{openModal:i}]=w(),[r,{openModal:c}]=w(),[u,{reload:m}]=o({api:t,searchInfo:{mode:e.value},columns:y,formConfig:{labelWidth:120,schemas:x},useSearchForm:!0,actionColumn:{width:250,title:"操作",dataIndex:"action"}});return d(e,(()=>{m({searchInfo:{mode:e.value}})})),{mode:e,registerTable:u,registerModal:r,handleCreate:function(){c(!0,{isUpdate:!1})},handleEdit:function(e){c(!0,{record:e})},viewModal:s,handleView:function(e){i(!0,{url:`/api/blade-flow/process/resource-view?processDefinitionId=${e.id}`})},handleDelete:function(e){return o=this,t=null,s=function*(){yield n({ids:e.id}),a.success("操作成功"),m()},new Promise(((e,a)=>{var n=e=>{try{r(s.next(e))}catch(o){a(o)}},i=e=>{try{r(s.throw(e))}catch(o){a(o)}},r=a=>a.done?e(a.value):Promise.resolve(a.value).then(n,i);r((s=s.apply(o,t)).next())}));var o,t,s},handleSuccess:function(){a.success("操作成功"),m()}}}}),C=g("通用流程"),S=g("定制流程");const T=s(_,[["render",function(e,a,o,t,n,s){const i=c("RadioButton"),r=c("RadioGroup"),l=c("TableAction"),d=c("BasicTable"),M=c("ManagerModal"),w=c("IframeModal");return u(),m("div",null,[f(d,{onRegister:e.registerTable},{toolbar:p((()=>[f(r,{value:e.mode,"onUpdate:value":a[0]||(a[0]=a=>e.mode=a),"button-style":"solid"},{default:p((()=>[f(i,{value:"1"},{default:p((()=>[C])),_:1}),f(i,{value:"2"},{default:p((()=>[S])),_:1})])),_:1},8,["value"])])),bodyCell:p((({column:a,record:o})=>["tenantId"===a.dataIndex?(u(),m(b,{key:0},[g(j(""===o.tenantId?"通用":o.tenantId),1)],64)):h("",!0),"version"===a.dataIndex?(u(),m(b,{key:1},[g(" v"+j(o.version),1)],64)):h("",!0),"suspensionState"===a.dataIndex?(u(),m(b,{key:2},[g(j(1===o.suspensionState?"激活":"挂起"),1)],64)):h("",!0),"category"===a.dataIndex?(u(),m(b,{key:3},[g(j(o.categoryName),1)],64)):h("",!0),"action"===a.dataIndex?(u(),v(l,{key:4,actions:[{auth:"flow_manager_state",label:"变更状态",icon:"clarity:note-edit-line",onClick:e.handleEdit.bind(null,o)},{auth:"flow_manager_image",label:"流程图",icon:"ant-design:picture-filled",onClick:e.handleView.bind(null,o)},{auth:"flow_manager_remove",label:"删除",icon:"ant-design:delete-outlined",color:"error",popConfirm:{title:"是否确认删除",confirm:e.handleDelete.bind(null,o)}}]},null,8,["actions"])):h("",!0)])),_:1},8,["onRegister"]),f(M,{onRegister:e.registerModal,onSuccess:e.handleSuccess},null,8,["onRegister","onSuccess"]),f(w,{onRegister:e.viewModal},null,8,["onRegister"])])}]]);export{T as default};
