var e=Object.defineProperty,t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,o=(t,r,a)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[r]=a,l=(e,t,r)=>new Promise(((a,o)=>{var l=e=>{try{s(r.next(e))}catch(t){o(t)}},n=e=>{try{s(r.throw(e))}catch(t){o(t)}},s=e=>e.done?a(e.value):Promise.resolve(e.value).then(l,n);s((r=r.apply(e,t)).next())}));import{B as n,u as s}from"./useForm-76a4ff23.js";import{y as i,s as d,a as c,w as u,f as p,k as m,ab as f,o as b,j as y,H as g,n as v,ag as h}from"./index-c5a6c875.js";import{B as w,u as I}from"./index-6c947566.js";import{a as P,s as j}from"./role-ff1ea5b0.js";const x=[{title:"角色名称",dataIndex:"roleName"},{title:"所属租户",dataIndex:"tenantId",defaultHidden:!i.tenantMode},{title:"角色别名",dataIndex:"roleAlias"},{title:"角色排序",dataIndex:"sort"}],O=[{field:"roleName",label:"角色名称",component:"Input",colProps:{span:8}},{field:"roleAlias",label:"角色别名",component:"Input",colProps:{span:8}}],D=[{field:"roleName",label:"角色名称",required:!0,component:"Input"},{field:"roleAlias",label:"角色别名",component:"Input",required:!0},{field:"parentId",label:"上级角色",component:"TreeSelect",componentProps:{fieldNames:{label:"title",value:"value"},getPopupContainer:()=>document.body}},{field:"sort",label:"角色排序",required:!0,component:"InputNumber"}];const F=d(c({name:"RoleDrawer",components:{BasicDrawer:w,BasicForm:n},emits:["success","register"],setup(e,{emit:n}){const i=u(!0),d=u(""),[c,{resetFields:f,setFieldsValue:b,validate:y,updateSchema:g}]=s({labelWidth:90,baseColProps:{span:24},schemas:D,showActionButtonGroup:!1,baseColProps:{span:24}}),[v,{setDrawerProps:h,closeDrawer:w}]=I((e=>l(this,null,(function*(){let l;f(),h({confirmLoading:!1}),i.value=!!(null==e?void 0:e.isUpdate),m(i)?(d.value=e.record.id,l=yield P({roleId:e.record.id}),b(((e,l)=>{for(var n in l||(l={}))r.call(l,n)&&o(e,n,l[n]);if(t)for(var n of t(l))a.call(l,n)&&o(e,n,l[n]);return e})({},e.record)),l.unshift({title:"顶级",key:"0",value:"0"})):l=yield P(),g([{field:"parentId",componentProps:{treeData:l}}])}))));return{registerDrawer:v,registerForm:c,getTitle:p((()=>m(i)?"编辑角色":"新增角色")),handleSubmit:function(){return l(this,null,(function*(){try{const e=yield y();h({confirmLoading:!0}),m(i)&&(e.id=d.value),yield j(e),w(),n("success")}finally{h({confirmLoading:!1})}}))}}}}),[["render",function(e,t,r,a,o,l){const n=f("BasicForm"),s=f("BasicDrawer");return b(),y(s,h(e.$attrs,{onRegister:e.registerDrawer,showFooter:"",title:e.getTitle,width:"500px",onOk:e.handleSubmit}),{default:g((()=>[v(n,{onRegister:e.registerForm},null,8,["onRegister"])])),_:1},16,["onRegister","title","onOk"])}]]),B=Object.freeze(Object.defineProperty({__proto__:null,default:F},Symbol.toStringTag,{value:"Module"}));export{F as R,B as a,x as c,O as s};
