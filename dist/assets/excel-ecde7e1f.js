var T=Object.defineProperty,B=Object.defineProperties;var C=Object.getOwnPropertyDescriptors;var d=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var w=(o,t,e)=>t in o?T(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e,b=(o,t)=>{for(var e in t||(t={}))v.call(t,e)&&w(o,e,t[e]);if(d)for(var e of d(t))F.call(t,e)&&w(o,e,t[e]);return o},x=(o,t)=>B(o,C(t));var h=(o,t,e)=>new Promise((n,s)=>{var r=l=>{try{a(e.next(l))}catch(i){s(i)}},c=l=>{try{a(e.throw(l))}catch(i){s(i)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,c);a((e=e.apply(o,t)).next())});import{A as N,D as A,h as D,c as L,F as O,G as V,B as M}from"./element-plus-3c3e7816.js";import{r as R,u as g,w as W}from"./xlsx-ec0d7d13.js";import{i as $}from"./lodash-es-81e82e73.js";import{g as q}from"./menu-2a3ae1f5.js";import{F as E,r as G,o as H,$ as J,a0 as m,a as y,a2 as p,ac as _,u as P}from"./@vue-0bd7c233.js";import"./lodash-unified-cbbf5a2b.js";import"./lodash-d8f670e1.js";import"./@amap-9fd45ac7.js";import"./@sxzz-ad8bfd58.js";import"./@vueuse-b3c2dc13.js";import"./@element-plus-9f43ecf9.js";import"./dayjs-604b50be.js";import"./async-validator-f102eabc.js";import"./@ctrl-83f18216.js";import"./escape-html-12e99df8.js";import"./normalize-wheel-es-c175a4cf.js";import"./vue-171b62d6.js";import"./@floating-ui-5f39704e.js";import"./memoize-one-0650c7b0.js";import"./pinia-c63b1ff9.js";import"./vue-demi-71ba0ef2.js";import"./axios-226f391c.js";import"./qs-b010a38c.js";import"./side-channel-a082fe58.js";import"./get-intrinsic-5660d814.js";import"./has-symbols-8f82dcae.js";import"./function-bind-22e7ee79.js";import"./has-26d28e02.js";import"./call-bind-75c15918.js";import"./object-inspect-4572ba77.js";import"./preload-helper-41c905a7.js";import"./vue-router-169b55e4.js";import"./nprogress-57f984c9.js";function U(o,t){const e=new FileReader;return e.readAsArrayBuffer(o),new Promise(n=>{e.onload=s=>{const r=s.target.result,c=R(r,{type:"array"}),a=c.SheetNames[0],l=c.Sheets[a],i=g.sheet_to_json(l);n(z(i,t))}})}function z(o,t){const e=[],n=$(t);return o.forEach(s=>{let r={};Object.keys(s).forEach(c=>{n[c]&&(r[n[c]]=s[c])}),e.push(r)}),e}function I(o){if(o)if(/.*[\u4e00-\u9fa5]+.*$/.test(o)){const t=o.match(/[\u4e00-\u9fa5]/g).length,e=o.length-t;return t*2.1+e*1.2}else return o=o.toString(),o.replace(/[\u0391-\uFFE5]/g,"aa").length;else return 4}function K(o,t,e=4){const n={};t["!cols"]=[],o.forEach(s=>{Object.keys(s).forEach(r=>{var a;const c=s[r];n[r]=Math.max((a=n[r])!=null?a:e,I(c))})}),Object.keys(n).forEach(s=>{t["!cols"].push({wch:n[s]})})}function Q({data:o,header:t,filename:e="表.xlsx",json2sheetOpts:n={},write2excelOpts:s={bookType:"xlsx"}}){let r=[...o];for(let l in t)t[l]||delete t[l];Object.keys(t).length&&(r=o.map(l=>{let i={};for(let u in t)i[u]=l[u];return i}),r.unshift(t),n.skipHeader=!0);const c=g.json_to_sheet(r,n);K(r,c);const a={SheetNames:[e],Sheets:{[e]:c}};W(a,e,s)}const X={class:"flex justify-between"},Y={class:"flex justify-between"},Z=E({name:"excel"}),Lt=E(x(b({},Z),{setup(o){const t={title:"菜单标题",icon:"菜单图标",createTime:"创建时间",updateTime:"更新时间"};let e=G([]);q({limit:10}).then(({data:r})=>{e.value=r});const n=c=>h(this,[c],function*({file:r}){console.time("导入时间");const a=yield U(r,t);console.log(a,"导入"),console.timeEnd("导入时间"),e.value.push(...a)}),s=()=>h(this,null,function*(){Q({data:e.value,header:t}),console.timeEnd("下载时间")});return(r,c)=>{const a=N,l=A,i=D,u=L,f=O,k=V,j=M;return H(),J(j,{shadow:"hover"},{header:m(()=>[y("nav",X,[p(i,null,{default:m(()=>[p(l,{"http-request":n,"show-file-list":!1},{trigger:m(()=>[p(a,{type:"primary"},{default:m(()=>[_("excel导入")]),_:1})]),_:1}),p(a,{type:"primary",onClick:s},{default:m(()=>[_("excel导出")]),_:1})]),_:1}),y("div",Y,[p(u,{href:"https://www.npmjs.com/package/xlsx",target:"_blank",type:"primary"},{default:m(()=>[_("excel导入导出")]),_:1})])])]),default:m(()=>[p(k,{data:P(e),"row-key":S=>S.id,border:"","highlight-current-row":"",stripe:""},{default:m(()=>[p(f,{label:"菜单标题",prop:"title","show-overflow-tooltip":"",width:"250"}),p(f,{label:"菜单图标",prop:"icon","show-overflow-tooltip":"",width:"180"}),p(f,{label:"创建时间",prop:"createTime","show-overflow-tooltip":""}),p(f,{label:"更新时间",prop:"updateTime","show-overflow-tooltip":""})]),_:1},8,["data","row-key"])]),_:1})}}}));export{Lt as default};
